(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d757"],{"0580":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrap-box",attrs:{id:"work-list"}},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("教室工单")])],1)],1),a("div",{staticClass:"router-view-wrap"},[a("div",{staticClass:"router-view-content"},[t.common.checkAuthority("WorkList-list",!0)?a("div",[a("el-table",{attrs:{data:t.tableData.rows}},[a("el-table-column",{attrs:{label:"申请人",prop:"user_name",width:"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"院系",prop:"faculty_name",width:"150px","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"实验名",prop:"experiment_name"}}),a("el-table-column",{attrs:{label:"电话",prop:"phone_num",width:"120px"}}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.common.checkAuthority("WorkList-detail",!0)},on:{click:function(a){t.showDetail(e.row)}}},[t._v("查 看")])]}}])})],1)],1):a("div",{staticClass:"text-center text-info"},[t._v(" 你无权查看此内容 ")])]),t.common.checkAuthority("WorkList-list",!0)?a("div",{staticClass:"router-view-bottom"},[a("div"),a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":t.pageNum,"page-size":t.pageSize,total:t.tableData.total},on:{"size-change":t.pageSizeChange,"current-change":t.pageCurrentChange}})],1):a("div",{staticClass:"router-view-bottom"},[a("div")]),a("el-dialog",{attrs:{visible:t.dialogDetailVisible,title:"工单详情",id:"work-list-dialog",loading:t.dialogLoading},on:{"update:visible":function(e){t.dialogDetailVisible=e}}},[a("h4",{staticClass:"text-info"},[t._v("已预约教室")]),t.detailData.classRooms?a("div",[a("el-card",{staticClass:"marb10",attrs:{"body-style":{padding:"0 20px"}}},[a("p",[a("span",[a("i",{staticClass:"fa fa-user"}),t._v("预约人："+t._s(t.detailData.user_name))]),a("span",{staticClass:"marl10"},[a("i",{staticClass:"fa fa-tag marl10"}),t._v("实验名称："+t._s(t.detailData.experiment_name))]),a("span",{staticClass:"marl10 fr"},[a("i",{staticClass:"fa fa-calendar marl10"}),t._v("预约时间："+t._s(t.common._convertDate(t.detailData.create_time,"yyyy年MM月dd日")))])]),t._l(t.detailData.classRooms,function(e,s){return a("el-card",{key:s+"已预约教室",staticClass:"marb10",attrs:{"body-style":{padding:"0 20px"}}},[a("p",[a("span",[a("i",{staticClass:"fa fa-paperclip"}),t._v("地址："+t._s(e.address))]),a("span",{staticClass:"marl10"},[a("i",{staticClass:"fa fa-paperclip marl10"}),t._v("编号："+t._s(e.identifier))])]),a("p",[a("span",[t._v("开始节次: "+t._s(e.timeTableRecord.begin_index)+"   时间: "+t._s(t.common._convertDate(e.timeTableRecord.begin_time,"yyyy年MM月dd日")))]),a("span",{staticClass:"fr"},[t._v("结束节次: "+t._s(e.timeTableRecord.end_index)+"   时间: "+t._s(t.common._convertDate(e.timeTableRecord.end_time,"yyyy年MM月dd日")))])])])})],2)],1):t._e(),a("h4",{staticClass:"text-info"},[t._v("冲突预约")]),t.detailData.conflictRecordVo?a("div",t._l(t.detailData.conflictRecordVo,function(e,s){return a("el-card",{key:s+"已预约人",staticClass:"marb10",attrs:{"body-style":{padding:"0 20px"}}},[a("p",[a("span",[a("i",{staticClass:"fa fa-user"}),t._v("预约人："+t._s(e.user_name))]),a("span",{staticClass:"marl10"},[a("i",{staticClass:"fa fa-tag marl10"}),t._v("实验名称："+t._s(e.experiment_name))]),a("span",{staticClass:"marl10 fr"},[a("i",{staticClass:"fa fa-calendar marl10"}),t._v("预约时间："+t._s(t.common._convertDate(e.create_time,"yyyy年MM月dd日")))])]),e.classRooms?a("div",t._l(e.classRooms,function(e,s){return a("el-card",{key:s+"冲突教室",staticClass:"marb10",attrs:{"body-style":{padding:"0 20px"}}},[a("p",{staticClass:"text-danger"},[a("i",{staticClass:"fa fa-home"}),a("span",[t._v("地址："+t._s(e.address)+" ")]),a("span",{staticClass:"marl10"},[a("i",{staticClass:"fa fa-paperclip marl10"}),t._v("编号："+t._s(e.identifier))])]),a("p",[a("span",[t._v("开始节次: "+t._s(e.timeTableRecord.begin_index)+"   时间: "+t._s(t.common._convertDate(e.timeTableRecord.begin_time,"yyyy年MM月dd日")))]),a("span",{staticClass:"fr"},[t._v("结束节次: "+t._s(e.timeTableRecord.end_index)+"   时间: "+t._s(t.common._convertDate(e.timeTableRecord.end_time,"yyyy年MM月dd日")))])])])})):t._e()])})):t._e(),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"default"},on:{click:function(e){t.dialogDetailVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"warning",disabled:!t.common.checkAuthority("WorkList-reject",!0)},on:{click:t.rejectWorkList}},[t._v("拒 绝")]),a("el-button",{attrs:{type:"primary",disabled:!t.common.checkAuthority("WorkList-agree",!0)},on:{click:t.confirmWorkList}},[t._v("同 意")])],1)])],1)],1)},i=[],o={data:function(){return{typeTree:JSON.parse(sessionStorage.getItem("typeTree")),typeTreeProps:{label:"d_name",value:"id",children:"children"},modelList:null,searchForm:{models:[],type_id:null,cur_status:null},tableData:{rows:[],total:0},pageNum:1,pageSize:10,dialogLoading:!1,dialogDetailVisible:!1,tempId:null,detailData:{}}},created:function(){},mounted:function(){this.common.checkAuthority("WorkList-list",!0)&&this.getTableList()},methods:{getTableList:function(){var t=this;this.tableLoading=!0;var e=this.searchForm;e.pageNum=this.pageNum,e.pageSize=this.pageSize,e.cur_status=2;var a={method:"post",url:"".concat(this.common.basePath,"/l_bespeak_record/list"),data:JSON.parse(JSON.stringify(e))};this.searchForm.models&&this.searchForm.models.length>0&&(a.data.model_id=this.searchForm.models[this.searchForm.models.length-1]),delete a.data.models,this.axios(a).then(function(e){t.tableData=e.data.data,t.$nextTick(function(e){t.tableLoading=!1})}).catch(function(e){t.tableLoading=!1,t.$message.error(e)})},clearForm:function(){this.searchForm={models:[],type_id:null,cur_status:null}},pageSizeChange:function(t){this.pageSize=t,this.getTableList()},pageCurrentChange:function(t){this.pageNum=t,this.getTableList()},showDetail:function(t){this.getWorkDetail(t.id)},getWorkDetail:function(t){var e=this;this.dialogLoading=!0;var a={method:"get",url:"".concat(this.common.basePath,"/l_bespeak_record/detail/").concat(t)};this.axios(a).then(function(a){e.tempId=t,e.detailData=a.data.data,e.dialogLoading=!1,e.dialogDetailVisible=!0}).catch(function(t){e.$message.error(t),e.dialogDetailVisible=!1,e.dialogLoading=!1})},scrapDevice:function(t,e){var a=this;this.common.scrapDevice(t,e).then(function(t){a.getTableList()}).catch(function(t){})},cascaderChanged:function(t){this.searchForm.type_id=null,this.getModelList(t[t.length-1])},getModelList:function(t){var e=this,a={method:"get",url:"".concat(this.common.basePath,"/spec/select/model/public"),params:{id:t,pageNum:1,pageSize:999}};this.axios(a).then(function(t){e.modelList=t.data.data.rows,e.$refs.deviceForm&&e.$refs.deviceForm.resetFields()}).catch(function(t){e.$message.error(t)})},confirmWorkList:function(){var t=this,e={method:"get",url:"".concat(this.common.basePath,"/l_bespeak_record/agree/").concat(this.tempId)};this.axios(e).then(function(e){t.getTableList(),t.$message.success(e.data.meta.message),t.dialogDetailVisible=!1}).catch(function(e){t.$message.error(e)})},rejectWorkList:function(){var t=this,e={method:"delete",url:"".concat(this.common.basePath,"/l_bespeak_record/reject/").concat(this.tempId)};this.axios(e).then(function(e){t.getTableList(),t.$message.success(e.data.meta.message),t.dialogDetailVisible=!1}).catch(function(e){t.$message.error(e)})}}},l=o,r=(a("dc1d"),a("2877")),n=Object(r["a"])(l,s,i,!1,null,null,null);n.options.__file="WorkList.vue";e["default"]=n.exports},"23e1":function(t,e,a){},dc1d:function(t,e,a){"use strict";var s=a("23e1"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-d757.b83aec80.js.map