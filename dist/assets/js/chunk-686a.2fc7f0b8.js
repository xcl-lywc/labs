(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-686a"],{"12f7":function(t,e,a){},cdc9:function(t,e,a){"use strict";var o=a("12f7"),s=a.n(o);s.a},f8ad:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("入库")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"router-view-wrap"},[a("div",{staticClass:"router-view-content"},[t.common.checkAuthority("Record-list",!0)?a("el-row",{staticClass:"padding-row"},[a("el-form",{ref:"searchForm",attrs:{model:t.searchForm,"label-width":"120px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"入库人：",prop:"consumer"}},[a("el-select",{staticClass:"fill-width",attrs:{placeholder:"请选择",filterable:""},model:{value:t.searchForm.consumer,callback:function(e){t.$set(t.searchForm,"consumer",e)},expression:"searchForm.consumer"}},t._l(t.userList,function(t,e){return a("el-option",{key:e+"入库人",attrs:{value:t.id,label:t.user_name}})}))],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"操作人：",prop:"creator"}},[a("el-select",{staticClass:"fill-width",attrs:{placeholder:"请选择",filterable:""},model:{value:t.searchForm.creator,callback:function(e){t.$set(t.searchForm,"creator",e)},expression:"searchForm.creator"}},t._l(t.userList_,function(t,e){return a("el-option",{key:e+"创建者",attrs:{value:t.id,label:t.user_name}})}))],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary",disabled:!t.common.checkAuthority("Record-query",!0)},on:{click:function(e){t.getInstockApplyList("init")}}},[t._v("搜索")]),a("el-button",{attrs:{type:"default"},on:{click:function(e){t.clearForm("searchForm")}}},[t._v("重置")])],1)],1)],1)],1),a("el-col",{attrs:{span:14}},[a("el-card",{attrs:{shadow:""}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("入库列表")])]),a("el-table",{staticClass:"el-table-instock",attrs:{"row-class-name":t.tableRowClassName,data:t.instockApplyList.rows,"show-header":!0},on:{"row-click":t.handleNodeClick}},[a("el-table-column",{attrs:{prop:"consumerName",label:"入库人",width:""}}),a("el-table-column",{attrs:{prop:"creatorName",label:"操作人",width:""}}),a("el-table-column",{attrs:{prop:"createTime","show-overflow-tooltip":"",label:"时间",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(t.common._convertDate(e.row.createTime,"yyyy/MM/dd"))+"\n                ")]}}])}),a("el-table-column",{attrs:{prop:"curStatus",label:"状态",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[2===e.row.curStatus?a("el-tag",{attrs:{type:"success"}},[t._v("已入库")]):t._e(),1===e.row.curStatus?a("el-tag",{attrs:{type:"warning"}},[t._v("未入库")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"inStockType","show-overflow-tooltip":"",label:"类型",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.inStockType?a("el-tag",{attrs:{type:"success"}},[t._v("入库")]):t._e(),2===e.row.inStockType?a("el-tag",{attrs:{type:"danger"}},[t._v("借出归还")]):t._e(),3===e.row.inStockType?a("el-tag",{attrs:{type:"warning"}},[t._v("维修入库")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.common.checkAuthority("Record-detail",!0)?a("el-button",{attrs:{type:"",size:"mini"},on:{click:function(a){a.stopPropagation(),t.$router.push({name:"InstockDetail",params:{id:e.row.id}})}}},[t._v("查看")]):t._e(),t.common.checkAuthority("Record-put",!0)?a("el-button",{attrs:{type:"success",size:"mini",disabled:2===e.row.curStatus},on:{click:function(a){a.stopPropagation(),t.confirmInstockApply(e.row)}}},[t._v("入库")]):t._e(),t.common.checkAuthority("Record-edit",!0)?a("el-button",{attrs:{type:"primary",size:"mini",disabled:2===e.row.curStatus},on:{click:function(a){a.stopPropagation(),t.$router.push({name:"InstockDetailedForm",params:{type:2,id:e.row.id}})}}},[t._v("编辑")]):t._e(),t.common.checkAuthority("Record-delete",!0)?a("el-button",{attrs:{type:"danger",size:"mini",disabled:2===e.row.curStatus},on:{click:function(a){a.stopPropagation(),t.deleteInstockApply(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t.instockApplyList.total>0?a("el-pagination",{staticClass:"text-right mart10",attrs:{background:"",small:"",layout:"prev, pager, next",total:t.instockApplyList.total},on:{"size-change":t.handleSizeChanged_,"current-change":t.handlePageChanged_}}):t._e()],1)],1),a("el-col",{attrs:{span:10}},[a("el-card",{attrs:{shadow:""}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("入库清单")])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{stripe:"",data:t.instockDetailedList.rows,"show-header":!0}},[a("el-table-column",{attrs:{type:"expand",label:"仓库"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-table",{attrs:{data:t.row.materialInStockInfoHasStorehouses,border:"","show-header":!0}},[a("el-table-column",{attrs:{prop:"address",align:"center",label:"教室",width:""}}),a("el-table-column",{attrs:{prop:"amount",align:"center",label:"数量",width:""}})],1)]}}])}),a("el-table-column",{attrs:{prop:"materialTypeName",label:"耗材类型","show-overflow-tooltip":"",width:""}}),a("el-table-column",{attrs:{prop:"materialModelName",label:"耗材型号","show-overflow-tooltip":"",width:""}}),a("el-table-column",{attrs:{prop:"modelType",label:"型号类型",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.modelType?a("el-tag",[t._v("耗材")]):t._e(),2===e.row.modelType?a("el-tag",{attrs:{type:"success"}},[t._v("设备")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"identifier",label:"设备编号","show-overflow-tooltip":"",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.identifier?a("span",[t._v(t._s(e.row.identifier))]):a("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"16px"}})]}}])}),a("el-table-column",{attrs:{prop:"serialNum",label:"设备序列号","show-overflow-tooltip":"",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.serialNum?a("span",[t._v(t._s(e.row.serialNum))]):a("i",{staticClass:"el-icon-close",staticStyle:{"font-size":"16px"}})]}}])}),a("el-table-column",{attrs:{prop:"amount",label:"数量",width:""}})],1),a("el-pagination",{staticClass:"text-right mart10 fr marb10",attrs:{background:"",layout:"total, sizes, prev, pager, next",total:t.instockDetailedList.total},on:{"size-change":t.handleSizeChanged,"current-change":t.handlePageChanged}})],1)],1)],1):a("div",{staticClass:"text-center text-info"},[t._v(" 你无权查看此内容 ")])],1),a("div",{staticClass:"router-view-bottom_"},[t.common.checkAuthority("Record-list",!0)?a("div",{staticClass:"overflow-hidden fill-width"},[a("el-button",{staticClass:"fr",attrs:{type:"primary",size:"",disabled:!t.common.checkAuthority("Record-create",!0)},on:{click:function(e){t.$router.push({name:"InstockDetailedForm",params:{type:1,id:1}})}}},[t._v("创建入库单")])],1):a("div",{staticClass:"text-center text-info"},[t._v(" 你无权查看此内容 ")])])])],1)},s=[],i={data:function(){return{pageLoading:!1,tableLoading:!1,userList:[],userList_:[],searchForm:{consumer:null,creator:null},instockApplyList:{rows:[],total:0},activeId:null,tempId:null,pageNum_:1,pageSize_:10,instockDetailedList:{rows:[],total:0},pageNum:1,pageSize:10}},created:function(){},mounted:function(){this.common.checkAuthority("Record-list",!0)&&(this.getUserList(),this.getUserList_(),this.getInstockApplyList("init"))},methods:{clearForm:function(t){var e=this;this.$nextTick(function(){e.$refs[t].resetFields()})},tableRowClassName:function(t){var e=t.row;t.rowIndex;return e.id===this.activeId?"active-row":""},getUserList:function(){var t=this,e={method:"post",url:"".concat(this.common.basePath,"/user/list"),data:{pageNum:1,pageSize:9999}};this.axios(e).then(function(e){t.userList=e.data.data.rows}).catch(function(e){t.$message.error(e)})},getUserList_:function(){var t=this,e={method:"post",url:"".concat(this.common.basePath,"/user/list"),data:{pageNum:1,pageSize:9999,roles:6}};this.axios(e).then(function(e){t.userList_=e.data.data.rows}).catch(function(e){t.$message.error(e)})},getInstockApplyList:function(t){var e=this;this.pageLoading=!0;var a=this.searchForm;"init"==t&&(this.pageNum_=1,this.pageSize_=10),a.pageNum=this.pageNum_,a.pageSize=this.pageSize_;var o={method:"post",url:"".concat(this.common.basePath,"/material_instock/select_apply"),data:JSON.parse(JSON.stringify(a))};this.axios(o).then(function(t){e.instockApplyList=t.data.data,t.data.data&&t.data.data.total>0?(e.activeId=t.data.data.rows[0].id,e.getInstockDetailedList(t.data.data.rows[0].id)):(e.activeId=null,e.instockDetailedList={rows:[],total:0}),e.pageLoading=!1}).catch(function(t){e.pageLoading=!1,e.$message.error(t)})},handleSizeChanged_:function(t){this.pageSize_=t,this.getInstockApplyList()},handlePageChanged_:function(t){this.pageNum_=t,this.getInstockApplyList()},handleNodeClick:function(t,e){this.pageNum=1,this.activeId=t.id,this.getInstockDetailedList(this.activeId)},getInstockDetailedList:function(t){var e=this;this.tableLoading=!0;var a={method:"post",url:"".concat(this.common.basePath,"/material_info/select"),data:{instockId:t,pageNum:this.pageNum,pageSize:this.pageSize}};this.axios(a).then(function(t){e.instockDetailedList=t.data.data,e.tableLoading=!1}).catch(function(t){e.tableLoading=!1,e.$message.error(t)})},handleSizeChanged:function(t){this.pageSize=t,this.getInstockDetailedList(this.activeId)},handlePageChanged:function(t){this.pageNum=t,this.getInstockDetailedList(this.activeId)},deleteInstockApply:function(t){var e=this;this.$confirm("当前删除的内容将无法找回","确认删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(a){var o={method:"get",url:"".concat(e.common.basePath,"/material_instock/delete"),params:{id:t.id}};e.axios(o).then(function(a){e.$message.success(a.data.meta.message),e.activeId==t.id&&(e.activeId=null),e.getInstockApplyList()}).catch(function(t){e.$message.error(t)})}).catch(function(t){})},confirmInstockApply:function(t){var e=this;this.$confirm("确认入库？","入库",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(a){var o={method:"post",url:"".concat(e.common.basePath,"/storehouse/in-stock/confirm"),params:{id:t.id}};e.axios(o).then(function(t){e.$message.success(t.data.meta.message),e.getInstockApplyList()}).catch(function(t){e.$message.error(t)})}).catch(function(t){})}}},n=i,r=(a("cdc9"),a("2877")),l=Object(r["a"])(n,o,s,!1,null,null,null);l.options.__file="Record.vue";e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-686a.2fc7f0b8.js.map