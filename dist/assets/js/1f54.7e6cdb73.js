(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["1f54"],{"1f54":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-wrap-box"},[i("el-card",{staticClass:"title-card"},[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",[t._v("权限管理")])],1)],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"router-view-wrap"},[i("div",{staticClass:"router-view-content"},[t.common.checkAuthority("Authority-tree",!0)?i("el-row",{staticClass:"padding-row"},[i("el-col",{attrs:{span:24}},[i("el-input",{attrs:{placeholder:"输入关键字进行过滤",clearable:""},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}})],1),i("el-col",{attrs:{span:24}},[i("div",[i("el-button",{attrs:{type:"primary",size:"mini",disabled:!!t.filterText||!t.common.checkAuthority("Authority-add",!0)},on:{click:function(e){t.addTree(null,1)}}},[t._v("添加顶级")])],1),t.treeData?i("el-tree",{ref:"authorityTree",attrs:{data:t.treeData,props:t.defaultProps,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!0,"filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.node,a=e.data;return i("span",{staticClass:"fill-width"},[i("div",{on:{mouseenter:function(e){t.tempId=a.id},mouseleave:function(e){t.tempId=null}}},[i("span",[1==a.type?i("i",{staticClass:"fa fa-desktop text-primary"}):t._e(),2==a.type?i("i",{staticClass:"fa fa-mouse-pointer text-info"}):t._e(),3==a.type?i("i",{staticClass:"fa fa-sitemap text-warning"}):t._e(),t._v("\n                    "+t._s(o.label)+"  \n                    "),t.tempId==a.id?i("span",[1==a.type&&t.common.checkAuthority("Authority-add",!0)?i("el-button",{attrs:{type:"text",disabled:!t.common.checkAuthority("Authority-add",!0)},on:{click:function(e){e.stopPropagation(),t.addTree(a,2)}}},[t._v("添加权限")]):t._e(),t.common.checkAuthority("Authority-edit",!0)?i("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.editTree(a)}}},[t._v("编辑")]):t._e(),a.childrens&&a.childrens.length>0||!t.common.checkAuthority("Authority-delete",!0)?t._e():i("el-button",{staticClass:"text-danger",attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.deleteTree(a)}}},[t._v("删除")])],1):t._e()])])])}}])}):t._e()],1)],1):t._e()],1),i("div",{staticClass:"router-view-bottom"})]),i("el-dialog",{attrs:{title:"权限",visible:t.dialogAuthorityVisible,width:"50vw"},on:{"update:visible":function(e){t.dialogAuthorityVisible=e}}},[i("el-form",{ref:"authorityForm",attrs:{model:t.authorityForm,"label-width":"100px",rules:t.rules}},[i("el-form-item",{attrs:{label:"权限名称：",prop:"name"}},[i("el-input",{model:{value:t.authorityForm.name,callback:function(e){t.$set(t.authorityForm,"name",e)},expression:"authorityForm.name"}})],1),i("el-form-item",{attrs:{label:"权限编码：",prop:"code"}},[i("el-input",{model:{value:t.authorityForm.code,callback:function(e){t.$set(t.authorityForm,"code",e)},expression:"authorityForm.code"}})],1),1!=t.authorityForm.type?i("el-form-item",{attrs:{label:"是否必要：",prop:"isRoot"}},[i("el-switch",{model:{value:t.authorityForm.isRoot,callback:function(e){t.$set(t.authorityForm,"isRoot",e)},expression:"authorityForm.isRoot"}})],1):t._e()],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogAuthorityVisible=!1}}},[t._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("authorityForm")}}},[t._v("确 定")])],1)],1)],1)},a=[],r=(i("7f7f"),i("cadf"),i("551c"),i("097d"),{data:function(){return{pageLoading:!1,filterText:"",activeNode:null,tempId:null,treeData:[],defaultProps:{children:"children",label:"name"},tableData:{rows:[],total:0},dialogAuthorityVisible:!1,operateType:"new",authorityForm:{name:null,code:null,isRoot:!1},rules:{name:[{required:!0,message:"请输入权限名称",trigger:"blur"}],code:[{required:!0,message:"请输入权限编码",trigger:"blur"}]}}},watch:{filterText:function(t){this.$refs.authorityTree.filter(t)}},mounted:function(){this.initAuthorityTree()},methods:{initAuthorityTree:function(){var t=this;this.pageLoading=!0;var e={method:"get",url:"".concat(this.common.basePath,"/resource/tree")};this.axios(e).then(function(e){t.treeData=e.data.data,t.activeNode=e.data.data[0].id,t.pageLoading=!1}).catch(function(e){t.pageLoading=!1,t.$message.error(e)})},addTree:function(t,e){this.operateType="new",this.dialogAuthorityVisible=!0,this.authorityForm={name:null,code:null,isRoot:!1,type:e},t&&(this.authorityForm.parent_id=t.id),this.clearForm()},editTree:function(t){this.operateType="edit",3==t.type?t.isRoot=!0:t.isRoot=!1,this.authorityForm=JSON.parse(JSON.stringify(t)),this.dialogAuthorityVisible=!0,this.clearForm()},clearForm:function(){var t=this;this.$nextTick(function(e){t.$refs.authorityForm.clearValidate()})},submitForm:function(t){var e=this;this[t].isRoot?this[t].type=3:this[t].type=2;var i={method:"edit"==this.operateType?"patch":"post",url:"".concat(this.common.basePath).concat("edit"==this.operateType?"/resource/update":"/resource/add/notes"),data:this[t]};this.$refs[t].validate(function(t){t?e.axios(i).then(function(t){e.$message.success(t.data.meta.message),e.dialogAuthorityVisible=!1,e.initAuthorityTree()}).catch(function(t){e.dialogAuthorityVisible=!1,e.$message.error(t)}):e.$message.error("请输入必填项")})},deleteTree:function(t){var e=this;this.authorityForm=JSON.parse(JSON.stringify(t)),this.$confirm("删除后需要重新添加","确认删除?",{"confirmButt才去onText":"确定",cancelButtonText:"取消",type:"warning"}).then(function(t){var i={method:"delete",url:"".concat(e.common.basePath,"/resource/delete/true/").concat(e.authorityForm.id)};e.axios(i).then(function(t){e.$message.success(t.data.meta.message),e.dialogAuthorityVisible=!1,e.initAuthorityTree()}).catch(function(t){e.dialogAuthorityVisible=!1,e.$message.error(t)})}).catch(function(t){})},handleNodeClick:function(t,e){this.activeNode=t.id},filterNode:function(t,e){return!t||-1!==e.name.indexOf(t)}}}),n=r,s=i("2877"),l=Object(s["a"])(n,o,a,!1,null,null,null);l.options.__file="Authority.vue";e["default"]=l.exports}}]);
//# sourceMappingURL=1f54.7e6cdb73.js.map