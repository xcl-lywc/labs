(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48f7"],{"1eec":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/lesson/testlist"}}},[e._v("实验列表")]),a("el-breadcrumb-item",{attrs:{to:{name:"TestDetail",params:{id:e.$route.params.experiment_id}}}},[e._v("实验详情")]),a("el-breadcrumb-item",[e._v("考勤表")])],1)],1),a("div",{staticClass:"router-view-wrap"},[a("div",{staticClass:"router-view-content"},[a("div",{staticStyle:{"overflow-x":"auto"}},[e.attendanceSheetData.length?e._e():a("div",{staticClass:"text-center"},[e._v("\n          暂无考勤\n        ")]),e.attendanceSheetData.length?a("table",{staticClass:"hand-table",staticStyle:{width:"max-content"}},[a("thead",{attrs:{border:"1"}},[a("tr",[a("td",[a("el-checkbox",{model:{value:e.isAllChecked,callback:function(t){e.isAllChecked=t},expression:"isAllChecked"}})],1),a("td",[e._v("学 号")]),a("td",[e._v("姓 名")]),e._l(e.attendanceSheetData[0].info,function(t,i){return a("td",[e._v("\n                "+e._s(t.taskName)+"   \n              ")])}),a("td",[e._v("得分")])],2)]),a("tbody",e._l(e.attendanceSheetData,function(t,i){return a("tr",{key:i},[a("td",{staticClass:"tab-index-class"},[a("el-checkbox",{model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"itemTit.checked"}})],1),a("td",{staticClass:"tab-index-class"},[e._v(e._s(t.account))]),a("td",{staticClass:"tab-index-class"},[e._v(e._s(t.name))]),e._l(t.info,function(t,i){return a("td",{key:i,staticClass:"tab-content-class"},[e._v(e._s(t.score))])}),a("td",{staticClass:"tab-index-class"},[e._v(e._s(t.scores))])],2)}))]):e._e()]),a("div",{staticClass:"router-view-bottom mart20"},[a("div",[a("el-button",{attrs:{disabled:!e.common.checkAuthority("AttendanceSheet_Edit",!0),type:"primary"},on:{click:e.showEditSheetDialog}},[e._v("\n              "+e._s(e.common.checkAuthority("AttendanceSheet_Edit")?e.common.checkAuthority("AttendanceSheet_Edit").name:"")+"\n          ")]),a("el-button",{attrs:{disabled:!e.common.checkAuthority("AttendanceSheet_DownloadSheetModule",!0),type:"primary"},on:{click:e.downloadSheetModule}},[e._v("\n            "+e._s(e.common.checkAuthority("AttendanceSheet_DownloadSheetModule")?e.common.checkAuthority("AttendanceSheet_DownloadSheetModule").name:"")+"\n          ")]),a("upload",{staticClass:"fl marl10",attrs:{size:"middle",url:"/work/import",isDisabled:!e.common.checkAuthority("AttendanceSheet_Import",!0),fileTypes:["xls","xlsx"],buttonText:e.common.checkAuthority("AttendanceSheet_Import")?e.common.checkAuthority("AttendanceSheet_Import").name:""},on:{uploadSuccess:e.importSheet}})],1)])])]),e.attendanceSheetData.length?a("el-dialog",{attrs:{width:"550px",title:"编辑考勤",visible:e.editSheetDialog},on:{"update:visible":function(t){e.editSheetDialog=t}}},[a("el-form",{ref:"editSheetForm",attrs:{model:e.editSheetForm,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"任务：",prop:"taskId",rules:[{required:!0,message:"请选择任务",trigger:"blur"}]}},[a("el-select",{model:{value:e.editSheetForm.taskId,callback:function(t){e.$set(e.editSheetForm,"taskId",t)},expression:"editSheetForm.taskId"}},e._l(e.attendanceSheetData[0].info,function(e,t){return a("el-option",{key:t,attrs:{label:e.taskName,value:e.taskId}})}))],1),a("el-form-item",{attrs:{label:"类型：",prop:"type",rules:[{required:!0,message:"请选择类型",trigger:"blur"}]}},[a("el-radio-group",{model:{value:e.editSheetForm.type,callback:function(t){e.$set(e.editSheetForm,"type",t)},expression:"editSheetForm.type"}},[a("el-radio",{attrs:{label:1}},[e._v("补卡")]),a("el-radio",{attrs:{label:2}},[e._v("清空打卡")])],1)],1),a("el-form-item",{attrs:{label:"补卡时间：",prop:"time",rules:[{required:!0,message:"请选择补卡时间",trigger:"blur"}]}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.editSheetForm.time,callback:function(t){e.$set(e.editSheetForm,"time",t)},expression:"editSheetForm.time"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editSheetDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editSheet("editSheetForm")}}},[e._v("保 存")])],1)],1):e._e()],1)},o=[],n=(a("ac6a"),a("d443")),s={components:{upload:n["a"]},data:function(){return{editSheetDialog:!1,isAllChecked:!1,attendanceSheetData:[],editSheetForm:{accounts:[],taskId:null,type:null,time:null}}},mounted:function(){this.getQueryList()},watch:{isAllChecked:function(e){this.attendanceSheetData.forEach(function(e){e.checked=!e.checked})}},methods:{getQueryList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/work/check/experimentId"),{params:{id:this.$route.params.experiment_id}}).then(function(t){e.attendanceSheetData=e._listAddCheckedKey(t.data.data)}).catch(function(t){e.$message.error(t)})},_listAddCheckedKey:function(e){return e&&e.forEach(function(e){e.checked=!1}),e},checkboxChange:function(e,t){e?this.editSheetForm.accounts.push(t.account):this.deleteAccount(t.account)},deleteAccount:function(e){for(var t=0;t<this.editSheetForm.accounts.length;t++)this.editSheetForm.accounts[t]===e?this.editSheetForm.accounts.splice(t,1):this.editSheetForm.accounts},showEditSheetDialog:function(){var e=this;if(this.editSheetForm.accounts=[],this.attendanceSheetData.forEach(function(t){t.checked&&e.editSheetForm.accounts.push(t.account)}),!this.editSheetForm.accounts.length)return this.$message.warning("请选择学生"),!1;this.$refs.editSheetForm&&this.$refs.editSheetForm.resetFields(),this.editSheetDialog=!0},editSheet:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.editSheetForm.time=t.editSheetForm.time.getTime(),t.axios.post("".concat(t.common.basePath,"/work/edit"),t.editSheetForm).then(function(e){t.$message.success(e.data.meta.message),t.getQueryList(),t.editSheetDialog=!1,t.isAllChecked=!1}).catch(function(e){t.$message.error(e),t.editSheetDialog=!1})})},importSheet:function(){this.getQueryList()},downloadSheetModule:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/work/export"),{params:{experiment_id:this.$route.params.experiment_id},responseType:"blob"}).then(function(t){e.common._fileBold(t),e.$message.success("下载成功")}).catch(function(t){e.$message.error(t)})}}},c=s,r=(a("9e2f"),a("2877")),l=Object(r["a"])(c,i,o,!1,null,null,null);l.options.__file="AttendanceSheet.vue";t["default"]=l.exports},3814:function(e,t,a){},"9e2f":function(e,t,a){"use strict";var i=a("3814"),o=a.n(i);o.a}}]);
//# sourceMappingURL=chunk-48f7.1a96921b.js.map