(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["79ac"],{"79ac":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("院系管理")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"router-view-wrap"},[a("div",{staticClass:"router-view-content"},[t.common.checkAuthority("Faculty-tree",!0)?a("el-row",{staticClass:"padding-row"},[a("el-col",{attrs:{span:24}},[a("div",[a("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.common.checkAuthority("Faculty-add",!0)},on:{click:function(e){t.addTree(null)}}},[t._v("添加顶级")])],1),t.facultyTreeData?a("el-tree",{attrs:{data:t.facultyTreeData,props:t.defaultProps,"node-key":"id","expand-on-click-node":!0},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,o=e.data;return a("span",{staticClass:"fill-width"},[a("el-tooltip",{attrs:{enterable:!1,content:i.label,placement:"right-start"}},[a("div",{on:{mouseenter:function(e){t.tempId=o.id},mouseleave:function(e){t.tempId=null}}},[a("span",[t._v("\n                    "+t._s(i.label)+"\n                    "),t.tempId==o.id?a("span",[t._v("\n                        \n                      "),!o.parent_id&&t.common.checkAuthority("Faculty-add",!0)?a("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.addTree(o)}}},[t._v("添加次级")]):t._e(),t.common.checkAuthority("Faculty-edit",!0)?a("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.editTree(o)}}},[t._v("编辑")]):t._e(),o.childrens&&o.childrens.length>0||!t.common.checkAuthority("Faculty-delete",!0)?t._e():a("el-button",{staticClass:"text-danger",attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.deleteTree(o)}}},[t._v("删除")])],1):t._e()])])])],1)}}])}):t._e()],1)],1):a("div",{staticClass:"text-center text-info"},[t._v(" 你无权查看此内容 ")])],1),a("div",{staticClass:"router-view-bottom"})]),a("el-dialog",{attrs:{title:"院系",visible:t.dialogTypeVisible,width:"50vw"},on:{"update:visible":function(e){t.dialogTypeVisible=e}}},[a("el-form",{ref:"facultyForm",attrs:{model:t.facultyForm,"label-width":"100px",rules:t.rules}},[a("el-form-item",{attrs:{label:"院系名称：",prop:"faculty"}},[a("el-input",{model:{value:t.facultyForm.faculty,callback:function(e){t.$set(t.facultyForm,"faculty",e)},expression:"facultyForm.faculty"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogTypeVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addTreeSubmit(null)}}},[t._v("确 定")])],1)],1)],1)},o=[],l={data:function(){return{pageLoading:!1,facultyTreeData:[],activeNode:null,tempId:null,defaultProps:{children:"childrens",label:"faculty"},tableData:{rows:[],total:0},dialogTypeVisible:!1,operateType:"new",facultyForm:{faculty:null},rules:{faculty:[{required:!0,message:"请输入院系名",trigger:"blur"}]}}},mounted:function(){this.common.checkAuthority("Faculty-tree",!0)&&this.initFacultyTree()},methods:{initFacultyTree:function(){var t=this;this.pageLoading=!0;var e={method:"get",url:"".concat(this.common.basePath,"/faculty/tree")};this.axios(e).then(function(e){t.facultyTreeData=e.data.data,t.activeNode=e.data.data[0].id,t.pageLoading=!1}).catch(function(e){t.pageLoading=!1,t.$message.error(e)})},addTree:function(t){this.operateType="new",this.dialogTypeVisible=!0,this.facultyForm={faculty:null},t&&(this.facultyForm.parent_id=t.id)},editTree:function(t){this.operateType="edit",this.dialogTypeVisible=!0,this.facultyForm=JSON.parse(JSON.stringify(t))},addTreeSubmit:function(t){var e=this,a={method:"new"==this.operateType?"post":"patch",url:"new"==this.operateType?"".concat(this.common.basePath,"/faculty/add"):"".concat(this.common.basePath,"/faculty/update"),data:this.facultyForm};"new"==this.operateType?this.facultyForm.cur_status=1:delete a.data.childrens,this.$refs.facultyForm.validate(function(t){t?e.axios(a).then(function(t){e.$message.success(t.data.meta.message),e.dialogTypeVisible=!1,e.initFacultyTree()}).catch(function(t){e.dialogTypeVisible=!1,e.$message.error(t)}):e.$message.error("请检查表单填写是否正确")})},deleteTree:function(t){var e=this;this.facultyForm=JSON.parse(JSON.stringify(t)),this.$confirm("删除后需要重新添加","确认删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(t){var a={method:"delete",url:"".concat(e.common.basePath,"/faculty/delete/").concat(e.facultyForm.id)};e.axios(a).then(function(t){e.$message.success(t.data.meta.message),e.dialogTypeVisible=!1,e.initFacultyTree()}).catch(function(t){e.dialogTypeVisible=!1,e.$message.error(t)})}).catch(function(t){})},handleNodeClick:function(t,e){this.activeNode=t.id}}},n=l,c=a("2877"),s=Object(c["a"])(n,i,o,!1,null,null,null);s.options.__file="Faculty.vue";e["default"]=s.exports}}]);
//# sourceMappingURL=79ac.3c1909c3.js.map