(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d3c1"],{"0d04":function(t,e,a){"use strict";var s=a("7b1f"),r=a.n(s);r.a},"7b1f":function(t,e,a){},bde9:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"contentWrap",staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{staticClass:"text-bold"},[a("div",{staticClass:"breadcrumb-div"},[a("div",{staticClass:"fl text-left-div"},[t._v("实验列表")]),a("div",{staticClass:"text-right fr"},[a("el-button",{attrs:{type:"primary",disabled:!t.common.checkAuthority("TestList_Add",!0)},on:{click:function(e){t.courseOperaDialog=!0,t.$refs.submitForm&&t.$refs.submitForm.resetFields()}}},[t._v("\n                "+t._s(t.common.checkAuthority("TestList_Add")?t.common.checkAuthority("TestList_Add").name:"")+"\n              ")]),a("el-button",{attrs:{disabled:t.isDisabaledDelBtn(),type:"danger"},on:{click:t.deleteExperiment}},[t._v("\n                "+t._s(t.common.checkAuthority("TestList_Delete")?t.common.checkAuthority("TestList_Delete").name:"")+"\n              ")])],1)])])],1)],1)],1),a("el-card",{staticClass:"operation-router-view-wrap mar15",attrs:{"body-style":{"padding-bottom":"0px"}}},[a("el-form",{ref:"searchForm",attrs:{model:t.searchForm,inline:!0,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"实验课程：",prop:"course_id"}},[a("el-select",{model:{value:t.searchForm.course_id,callback:function(e){t.$set(t.searchForm,"course_id",e)},expression:"searchForm.course_id"}},t._l(t.courseListData.rows,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.name}})}))],1),a("el-form-item",{attrs:{label:"实验名称：",prop:"name"}},[a("el-input",{model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),a("el-form-item",{attrs:{label:"创建时间："}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateTE,callback:function(e){t.dateTE=e},expression:"dateTE"}})],1),a("el-form-item",{attrs:{label:"实验状态：",prop:"condition"}},[a("el-select",{model:{value:t.searchForm.condition,callback:function(e){t.$set(t.searchForm,"condition",e)},expression:"searchForm.condition"}},[a("el-option",{attrs:{value:"1",label:"我参与"}}),a("el-option",{attrs:{value:"2",label:"没老师"}}),a("el-option",{attrs:{value:"3",label:"没学生"}}),a("el-option",{attrs:{value:"4",label:"没任务"}})],1)],1),a("el-form-item",{attrs:{label:"学年：",prop:"c_year"}},[a("el-select",{on:{change:function(e){t.yearChange(e,"search")}},model:{value:t.searchForm.c_year,callback:function(e){t.$set(t.searchForm,"c_year",e)},expression:"searchForm.c_year"}},t._l(t.yearList.rows,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.name}})}))],1),a("el-form-item",{attrs:{label:"学期：",prop:"c_stage"}},[a("el-select",{model:{value:t.searchForm.c_stage,callback:function(e){t.$set(t.searchForm,"c_stage",e)},expression:"searchForm.c_stage"}},t._l(t.schoolList.rows,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.name}})}))],1),a("el-form-item",[a("el-button",{attrs:{disabled:!t.common.checkAuthority("TestList_QueryList",!0),type:"primary"},on:{click:function(e){t.getQueryList(!0)}}},[t._v("\n            "+t._s(t.common.checkAuthority("TestList_QueryList")?t.common.checkAuthority("TestList_QueryList").name:"")+"\n          ")]),a("el-button",{attrs:{type:"primary"},on:{click:t.resetSearchForm}},[t._v("置空")])],1)],1)],1),a("div",{ref:"contentWrap",staticClass:"router-view-wrap mart0"},[a("div",{staticClass:"router-view-content"},[a("el-checkbox-group",{attrs:{size:"small"},model:{value:t.ids,callback:function(e){t.ids=e},expression:"ids"}},[a("el-row",{staticClass:"padding-row"},[t._l(t.listData.rows,function(e,s){return t.listData.rows.length?a("el-col",{key:s,attrs:{span:8}},[a("el-card",{staticClass:"card-wrap card-wrap_s",staticStyle:{height:"343px!important"}},[a("el-tag",{staticClass:"width-percentage"},[a("h3",{staticClass:"card-title"},[a("el-checkbox",{attrs:{label:e.id,disabled:!t.common.checkAuthority("TestList_Delete",!0)}},[t._v(" ")]),a("span",{staticClass:"card-title cursor-pointer",staticStyle:{"margin-left":"-5px"},on:{click:function(a){t.goToDetail(e.id)}}},[t._v(t._s(e.name))])],1)]),a("div",{staticClass:"mar10"},[a("p",{staticClass:" card-content cursor-pointer_T mart5",staticStyle:{height:"158px","-webkit-line-clamp":"11"},on:{click:function(a){t.goToDetail(e.id)}}},[t._v("\n                  描述："+t._s(e.description)+"\n                ")]),a("div",{staticClass:"card-bottom cursor-pointer",on:{click:function(a){t.goToDetail(e.id)}}},[e.bespeakRecords.length?a("div",{staticClass:"mart10",staticStyle:{"line-height":"19px",height:"75px"}},[a("span",[t._v("实验安排：")]),t._l(e.bespeakRecords,function(e,s){return a("p",{staticClass:"mar0 mart5",staticStyle:{"line-height":"19px"}},[a("span",[t._v(t._s(t.common._convertDate(e.begin_time,"yyyy.MM.dd"))+"：")]),a("span",[t._v(t._s(e.begin_index)+" ~ ")]),a("span",[t._v(t._s(t.common._convertDate(e.begin_time,"yyyy.MM.dd"))+"：")]),a("span",[t._v(t._s(e.end_index))]),t._v("\n                      教室："),t._l(e.classRooms,function(s,r){return a("span",{key:r},[t._v(t._s(s.name)+t._s(r<e.classRooms.length-1?"、":""))])})],2)})],2):t._e(),e.bespeakRecords.length?t._e():a("div",{staticClass:"mar0 ",staticStyle:{height:"75px"}},[a("p",{staticClass:"mar0"},[t._v("实验安排：暂无安排")])])])])],1)],1):t._e()}),t.listData.rows.length?t._e():a("el-col",{staticClass:"padding-row text-center text-info",attrs:{span:24}},[t._v("暂无数据")])],2)],1)],1),a("el-dialog",{attrs:{width:"550px",title:"创建实验",visible:t.courseOperaDialog},on:{"update:visible":function(e){t.courseOperaDialog=e}}},[a("el-form",{ref:"submitForm",attrs:{model:t.submitForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"所属课程：",prop:"course_id",rules:[{required:!0,message:"请选择课程",trigger:"blur"}]}},[a("el-select",{model:{value:t.submitForm.course_id,callback:function(e){t.$set(t.submitForm,"course_id",e)},expression:"submitForm.course_id"}},t._l(t.courseListData.rows,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.name}})}))],1),a("el-form-item",{attrs:{label:"实验名称：",prop:"name",rules:[{required:!0,message:"请输入课程名称",trigger:"blur"},{validator:function(e,a,s){t.common.wordNumberValid(e,a,s,"single")},trigger:"blur"}]}},[a("el-input",{model:{value:t.submitForm.name,callback:function(e){t.$set(t.submitForm,"name",e)},expression:"submitForm.name"}})],1),a("el-form-item",{attrs:{label:"实验类型：",prop:"etype",rules:[{required:!0,message:"请选择实验类型",trigger:"blur"}]}},[a("el-radio-group",{model:{value:t.submitForm.etype,callback:function(e){t.$set(t.submitForm,"etype",e)},expression:"submitForm.etype"}},[a("el-radio",{attrs:{label:1}},[t._v("个人实验")]),a("el-radio",{attrs:{label:2}},[t._v("小组实验")])],1)],1),a("el-form-item",{attrs:{label:"实验简介：",prop:"description",rules:[{required:!0,message:"请输入实验简介",trigger:"blur"},{validator:function(e,a,s){t.common.wordNumberValid(e,a,s,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:t.submitForm.description,callback:function(e){t.$set(t.submitForm,"description",e)},expression:"submitForm.description"}})],1),a("el-form-item",{attrs:{label:"得分占比：",prop:"value",rules:[{required:!0,message:"请输入得分占比",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1,max:100},model:{value:t.submitForm.value,callback:function(e){t.$set(t.submitForm,"value",e)},expression:"submitForm.value"}}),t._v(" %\n          ")],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.courseOperaDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submit("submitForm")}}},[t._v("保存")])],1)],1)],1)],1)},r=[],i=(a("cadf"),a("551c"),a("097d"),{data:function(){return{ids:[],scrollLoadSw:!0,dateTE:null,searchForm:{name:null,course_id:null,begin_time:null,end_time:null,condition:null,pageNum:this.common.elementPagination.pageNumDefault,pageSize:this.common.elementPagination.pageSizeDefault,c_year:null,c_stage:null},listData:{total:0,rows:[]},courseListData:{total:0,rows:[]},yearList:{total:0,rows:[]},schoolList:{total:0,rows:[]},courseOperaDialog:!1,submitForm:{name:null,description:null,etype:null,course_id:null,value:null}}},watch:{},mounted:function(){var t=this,e=this.$refs.contentWrap;e.addEventListener("scroll",function(){e.clientHeight+50>=e.scrollHeight-e.scrollTop&&t.scrollLoadSw&&(t.scrollLoadSw=!1,t.searchForm.pageNum<t.listData.total/t.searchForm.pageSize&&t.getQueryList(!1))},!1),this.getQueryList(!0),this.getQueryCourseList(),this.getYearList(),this.getDefaultYearSchool()},methods:{getDefaultYearSchool:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/configSemester/now"),{}).then(function(e){if(e.data.data)for(var a in e.data.data)"学年"==a?(t.searchForm.c_year=e.data.data[a],t.getSchoolList(t.searchForm.c_year)):"学期"==a&&(t.searchForm.c_stage=e.data.data[a])}).catch(function(e){t.$message.error(e)})},getYearList:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/configSemester?type_id=1"),{}).then(function(e){t.yearList=e.data.data}).catch(function(e){t.$message.error(e)})},getSchoolList:function(t){var e=this;this.axios.get("".concat(this.common.basePath,"/configSemester?type_id=2&parent_id=").concat(t),{}).then(function(t){e.schoolList=t.data.data}).catch(function(t){e.$message.error(t)})},isDisabaledDelBtn:function(){return!1!==!this.common.checkAuthority("TestList_Delete",!0)||0==this.ids.length},getQueryList:function(t){var e=this;this.axios.get("".concat(this.common.basePath,"/experiment"),{params:this._queryParams(t)}).then(function(a){t?e.listData=a.data.data:(e.listData.rows=e.listData.rows.concat(a.data.data.rows),e.listData.total=a.data.data.total),e.scrollLoadSw=!0}).catch(function(t){e.$message.error(t),e.scrollLoadSw=!0})},_queryParams:function(t){return t?this.searchForm.pageNum=1:this.searchForm.pageNum++,this.searchForm.orderId=1,this.searchForm.begin_time=this.dateTE?this.dateTE[0].getTime():null,this.searchForm.end_time=this.dateTE?this.dateTE[1].getTime():null,this.searchForm},getQueryCourseList:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/course"),"").then(function(e){t.courseListData=e.data.data}).catch(function(e){t.$message.error(e)})},submit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.axios.post("".concat(e.common.basePath,"/experiment"),e.submitForm).then(function(t){e.getQueryList(!0),e.courseOperaDialog=!1,e.$message.success(t.data.meta.message)}).catch(function(t){e.$message.error(t),e.courseOperaDialog=!1})})},goToDetail:function(t){this.common.checkAuthority("TestList_QueryDetail",!0)?this.$router.push({name:"TestDetail",params:{id:t}}):this.$message("无权限,不能查看详情")},resetSearchForm:function(){this.$refs.searchForm&&this.$refs.searchForm.resetFields(),this.dateTE=null},deleteExperiment:function(){var t=this;this.$confirm("是否删除所选实验?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteExperiment_()}).catch(function(){})},deleteExperiment_:function(){var t=this;this.axios.post("".concat(this.common.basePath,"/experiment/delete/batch"),this.ids).then(function(e){t.$message.success(e.data.meta.message),t.getQueryList(!0),t.ids=[]}).catch(function(e){t.$message.error(e),t.ids=[]})},yearChange:function(t,e){"search"==e&&(this.searchForm.c_stage=null),this.getSchoolList(t)}}}),o=i,n=(a("0d04"),a("2877")),l=Object(n["a"])(o,s,r,!1,null,null,null);l.options.__file="TestList.vue";e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-d3c1.1229cc4e.js.map