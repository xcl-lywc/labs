(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14a1"],{"88d6":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{ref:"contentWrap",staticClass:"content-wrap-box"},[e("el-card",{staticClass:"title-card"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{staticClass:"text-bold"},[e("div",{staticClass:"breadcrumb-div"},[e("div",{staticClass:"fl text-left-div"},[t._v("实验室列表")]),e("div",{staticClass:"text-right fr"},[e("el-button",{attrs:{type:"primary",disabled:!t.common.checkAuthority("LabList_Add",!0)},on:{click:function(a){t.dialogType=1,t.dialogTitle="创建实验室",t.roomOperaDialog=!0,t.$refs.submitForm&&t.$refs.submitForm.resetFields()}}},[t._v("新增")]),e("el-button",{attrs:{type:"danger",disabled:t.isDisabaledDelBtn()},on:{click:t.deleteRoom}},[t._v("删除")])],1)])])],1)],1),e("div",{ref:"contentWrap",staticClass:"router-view-wrap operation-router-view-wrap"},[e("div",{staticClass:"router-view-content"},[e("el-form",{ref:"searchForm",attrs:{model:t.searchForm,inline:!0,"label-width":"120px"}},[e("el-form-item",{attrs:{label:"实验室名称："}},[e("el-input",{model:{value:t.searchForm.keys,callback:function(a){t.$set(t.searchForm,"keys",a)},expression:"searchForm.keys"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",disabled:!t.common.checkAuthority("LabList_Search",!0)},on:{click:function(a){t.getQueryList(!0)}}},[t._v("搜索")]),e("el-button",{attrs:{type:"default"},on:{click:t.clearForm}},[t._v("置空")])],1)],1),e("div",{staticClass:"text-right overflow-hidden"},[e("span",{staticClass:"mart10 marl20 text-left fl"},[t._v(t._s("共计"+t.cardsData.total+"个实验室"))])]),t.common.checkAuthority("LabList_Search",!0)?e("div",{staticClass:"padding-row"},[t.cardsData.rows.length>0?e("el-row",{staticClass:"padding-row"},[e("el-checkbox-group",{attrs:{size:"small"},model:{value:t.ids,callback:function(a){t.ids=a},expression:"ids"}},t._l(t.cardsData.rows,function(a,s){return e("el-col",{key:s,attrs:{span:8}},[e("el-card",{staticClass:"card-wrap card-wrap_m"},[e("el-tag",{staticClass:"width-percentage",attrs:{type:"success"}},[e("h3",{staticClass:"card-title marb0"},[e("el-checkbox",{attrs:{label:a.id,disabled:!t.common.checkAuthority("LabList_Delete",!0)}},[t._v(" ")]),e("span",{staticClass:"card-title"},[t._v(t._s(a.name))])],1)]),e("p",{staticClass:"card-content_ card-content cursor-pointer_T"},[t._v("简介："+t._s(a.instructions))]),e("div",{staticClass:"card-bottom_"},[e("div",{staticClass:"room"},[e("span",{staticClass:"fl"},[t._v("教室:  ")]),0!=a.childrenVos.length?e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},t._l(a.childrenVos,function(a){return e("span",[t._v("\n                        "+t._s(a.code+" ( "+a.capacity+"人 ) ")+" \n                      ")])})),e("div",{staticClass:"room-list fl cursor-pointer"},t._l(a.childrenVos,function(a){return e("span",[t._v("\n                        "+t._s(a.code+" ( "+a.capacity+"人 ) ")+" \n                      ")])}))]):t._e(),0==a.childrenVos.length?e("span",{staticClass:"fl room-list"},[t._v("暂无")]):t._e()],1),e("div",{staticClass:"remarks"},[a.remarks?e("el-tooltip",{attrs:{effect:"dark",content:a.remarks,placement:"top"}},[e("span",{staticClass:"remarks-info fl cursor-pointer"},[t._v("备注: "+t._s(a.remarks))])]):e("span",{staticClass:"remarks-info fl"},[t._v("备注: 暂无")]),e("el-button",{staticClass:"fr",attrs:{type:"primary",size:"mini",disabled:!t.common.checkAuthority("LabList_Edit",!0)},on:{click:function(e){t.dialogType=2,t.dialogTitle="编辑实验室",t.getClassList(),t.roomOperaDialog=!0,t.$refs.submitForm&&t.$refs.submitForm.resetFields(),t.editId=a.id,t.echoLabInfo(a.id)}}},[t._v("编辑")])],1)])],1)],1)}))],1):e("el-row",{staticClass:"padding-row text-center text-info"},[t._v("\n          暂无数据\n        ")])],1):e("div",{staticClass:"text-center text-info"},[t._v(" 你无权查看此内容 ")])],1),e("el-dialog",{attrs:{width:"550px",title:t.dialogTitle,visible:t.roomOperaDialog},on:{"update:visible":function(a){t.roomOperaDialog=a}}},[e("el-form",{ref:"submitForm",attrs:{model:t.submitForm,"label-width":"110px"}},[e("el-form-item",{attrs:{label:"实验室名称：",prop:"l_name",rules:[{required:!0,message:"请输入实验室名称",trigger:"blur"},{validator:function(a,e,s){t.common.wordNumberValid(a,e,s,"single")},trigger:"blur"}]}},[e("el-input",{model:{value:t.submitForm.l_name,callback:function(a){t.$set(t.submitForm,"l_name",a)},expression:"submitForm.l_name"}})],1),e("el-form-item",{attrs:{label:"使用描述：",prop:"instructions",rules:[{required:!0,message:"请输入使用描述",trigger:"blur"},{validator:function(a,e,s){t.common.wordNumberValid(a,e,s,"textarea")},trigger:"blur"}]}},[e("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.submitForm.instructions,callback:function(a){t.$set(t.submitForm,"instructions",a)},expression:"submitForm.instructions"}})],1),e("el-form-item",{attrs:{label:"备注：",rules:[{validator:function(a,e,s){t.common.wordNumberValid(a,e,s,"textarea")},trigger:"blur"}],prop:"remarks"}},[e("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:t.submitForm.remarks,callback:function(a){t.$set(t.submitForm,"remarks",a)},expression:"submitForm.remarks"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.roomOperaDialog=!1}}},[t._v("取 消")]),1===t.dialogType?e("el-button",{attrs:{type:"primary"},on:{click:function(a){t.submit("submitForm")}}},[t._v("保 存")]):t._e(),2===t.dialogType?e("el-button",{attrs:{type:"primary"},on:{click:function(a){t.submit_("submitForm")}}},[t._v("保 存")]):t._e()],1)],1)],1)],1)},r=[],o={data:function(){return{searchForm:{keys:null,pageNum:this.common.elementPagination.pageNumDefault,pageSize:this.common.elementPagination.pageSizeDefault},scrollLoadSw:!0,cardsData:{rows:[],total:0},classListData:null,dialogType:null,dialogTitle:null,roomOperaDialog:!1,submitForm:{l_name:null,instructions:null,remarks:null},class_id:null,ids:[],editId:null}},created:function(){console.log(this.$store.state.authority)},mounted:function(){var t=this,a=this.$refs.contentWrap;a.addEventListener("scroll",function(){a.clientHeight+50>=a.scrollHeight-a.scrollTop&&t.scrollLoadSw&&(t.scrollLoadSw=!1,t.searchForm.pageNum<t.cardsData.total/t.searchForm.pageSize&&t.getQueryList(!1))},!1),this.getQueryList(!0)},methods:{getQueryList:function(t){var a=this;this.axios.get("".concat(this.common.basePath,"/lab/list"),{params:this._queryParams(t)}).then(function(e){t?a.cardsData=e.data.data:(a.cardsData.rows=a.cardsData.rows.concat(e.data.data.rows),a.cardsData.total=e.data.data.total),a.scrollLoadSw=!0}).catch(function(t){a.$message.error(t),a.scrollLoadSw=!0})},_queryParams:function(t){return t?this.searchForm.pageNum=1:this.searchForm.pageNum++,this.searchForm},clearForm:function(){this.searchForm.keys=null},getClassList:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/class/list"),{params:{pageNum:1,pageSize:10}}).then(function(a){t.axios.get("".concat(t.common.basePath,"/class/list"),{params:{pageNum:1,pageSize:a.data.data.total}}).then(function(a){t.classListData=a.data.data.rows}).catch(function(a){t.$message.error(a)})}).catch(function(a){t.$message.error(a)})},submit:function(t){var a=this;this.$refs[t].validate(function(t){if(!t)return!1;a.axios.post("".concat(a.common.basePath,"/lab"),a.submitForm).then(function(t){a.getQueryList(!0),a.$message.success("成功!"),a.roomOperaDialog=!1}).catch(function(t){a.$message.error(t),a.roomOperaDialog=!1})})},resetSearchForm:function(){this.$refs.searchForm&&this.$refs.searchForm.resetFields()},deleteRoom:function(){var t=this;this.$confirm("将是否删除所选实验室?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=new FormData;a.append("ids",t.ids),t.axios.patch("".concat(t.common.basePath,"/lab/delete"),a).then(function(a){t.$message.success("成功!"),t.getQueryList(!0),t.ids=[]}).catch(function(a){t.$message.error(a),t.ids=[]})}).catch(function(){})},isDisabaledDelBtn:function(){return!1!==!this.common.checkAuthority("LabList_Delete",!0)||0==this.ids.length},goToDetail:function(t){this.$router.push({name:"TestDetail",params:{id:t}})},echoLabInfo:function(t){var a=this;this.axios.get("".concat(this.common.basePath,"/lab/").concat(t),{params:{}}).then(function(t){a.submitForm.instructions=t.data.data.instructions,a.submitForm.remarks=t.data.data.remarks,a.submitForm.l_name=t.data.data.l_name,a.submitForm.capacity=t.data.data.size,a.$set(a.submitForm,"code",t.data.data.address)}).catch(function(t){a.$message.error(t)})},submit_:function(t){var a=this;this.$refs[t].validate(function(t){if(!t)return!1;var e={instructions:a.submitForm.instructions,remarks:a.submitForm.remarks,l_name:a.submitForm.l_name,size:a.submitForm.capacity,address:a.submitForm.code};a.axios.patch("".concat(a.common.basePath,"/lab/").concat(a.editId),e).then(function(t){a.getQueryList(!0),a.$message.success("成功!"),a.roomOperaDialog=!1}).catch(function(t){a.$message.error(t),a.roomOperaDialog=!1})})}}},i=o,n=(e("8d11"),e("2877")),c=Object(n["a"])(i,s,r,!1,null,"626424bd",null);c.options.__file="LabList.vue";a["default"]=c.exports},"8d11":function(t,a,e){"use strict";var s=e("a10e"),r=e.n(s);r.a},a10e:function(t,a,e){}}]);
//# sourceMappingURL=chunk-14a1.661c6821.js.map