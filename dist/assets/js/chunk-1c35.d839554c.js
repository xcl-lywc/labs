(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c35"],{"7bfb":function(e,t,a){"use strict";var s=a("dec0"),r=a.n(s);r.a},"92ac":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/lesson/testlist"}}},[e._v("实验列表")]),a("el-breadcrumb-item",[e._v("实验详情")])],1)],1),a("div",{staticClass:"router-view-wrap transparent-bg"},[a("div",{staticClass:"router-view-content"},[e.common.checkAuthority("TestDetail_QueryBasicsDetailMoudle",!0)&&e.detailData?a("el-card",{staticClass:"basics_desc"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("简介")])]),a("el-row",[a("el-col",{staticClass:"marb10",attrs:{span:12}},[a("span",[e._v("所属课程： ")]),e._v(e._s(e.detailData.courseName))]),a("el-col",{staticClass:"marb10",attrs:{span:12}},[a("span",[e._v("实验类型： ")]),e._v(e._s(1==e.detailData.etype?"个人实验":"小组实验"))]),a("el-col",{staticClass:"marb10",attrs:{span:12}},[a("span",[e._v("实验： ")]),e._v(e._s(e.detailData.name))]),a("el-col",{staticClass:"marb10",attrs:{span:12}},[a("span",[e._v("得分占比： ")]),e._v(e._s(e.detailData.value?e.detailData.value+"%":"无"))]),a("el-col",{staticClass:"marb10",attrs:{span:12}},[a("span",[e._v("满分： ")]),e._v(e._s(e.detailData.score?e.detailData.score:"100")+"分")]),a("el-col",{staticClass:"marb10 inline-flex",attrs:{span:24}},[a("span",[e._v("简介：")]),a("span",{staticClass:"cursor-pointer_T "},[e._v(e._s(e.detailData.description))])])],1),a("p",{staticClass:"text-right"},[a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_EditBasicsDetail",!0),type:"primary"},on:{click:function(t){e.editTestDialog=!0}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_EditBasicsDetail")?e.common.checkAuthority("TestDetail_EditBasicsDetail").name:"")+"\n          ")]),!e.detailData.template&&e.detailData.courseTemplate?a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_Base",!0),type:"primary"},on:{click:e.upGradeBase}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_Base")?e.common.checkAuthority("TestDetail_Base").name:"")+"\n          ")]):e._e()],1),a("p",[e._v("实验资料：")]),a("p",e._l(e.detailData.experimentsData,function(t,s){return a("el-tag",{key:s,staticClass:"marr10 mart10",attrs:{closable:e.common.checkAuthority("TestDetail_DeleteFile",!0),type:t.type},on:{close:function(a){e.handleTagClose(t)}}},[e.common.checkAuthority("TestDetail_AddTestData",!0)?a("a",{attrs:{href:""+e.common.publicBasePath+t.path,target:"_blank"}},[e._v(e._s(t.name))]):a("span",[e._v(e._s(t.name))])])})),a("p",[a("upload",{attrs:{isDisabled:!e.common.checkAuthority("TestDetail_AddTestData",!0),buttonText:e.common.checkAuthority("TestDetail_AddTestData")?e.common.checkAuthority("TestDetail_AddTestData").name:""},on:{uploadSuccess:function(t){e.uploadSuccess("experimentsData",t)}}})],1)],1):e._e(),e.common.checkAuthority("TestDetail_QueryExperimentalArrangementMoudle",!0)?a("el-card",{staticClass:"mart20"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("实验安排"),a("span",{staticStyle:{"font-size":"12px"}},[e._v("（注意：实验室全天共可排14个课时）")])])]),e._l(e.lBespeakRecordListData,function(t,s){return a("el-card",{key:s,staticClass:"mart5"},[a("span",[e._v("开始节次："+e._s(e.common._convertDate(t.begin_time,"yyyy年MM月dd日"))+"：")]),a("span",[e._v(e._s(t.begin_index)+" ~ ")]),a("span",[e._v("结束节次："+e._s(e.common._convertDate(t.begin_time,"yyyy年MM月dd日"))+"：")]),a("span",[e._v(e._s(t.end_index))]),e._v("\n          教室："),e._l(t.classRooms,function(s,r){return a("span",{key:r},[e._v(e._s(s.name)+e._s(r<t.classRooms.length-1?"、":""))])}),a("el-button",{staticClass:"marl10",attrs:{disabled:!e.common.checkAuthority("TestDetail_DeleteTestArrage",!0),type:"danger",size:"small"},on:{click:function(a){e.deleteLBespeakRecord(t.l_bespeak_id)}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_DeleteTestArrage")?e.common.checkAuthority("TestDetail_DeleteTestArrage").name:"")+"\n          ")])],2)}),a("p",{staticClass:"text-right"},[a("el-button",{staticClass:"marl10",attrs:{disabled:!e.common.checkAuthority("TestDetail_DeleteTestArrage",!0),type:"primary",size:"small"},on:{click:e.supplementClassShow}},[e._v("\n             补录课时\n          ")]),a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_BookingClassroom",!0),type:"primary",size:"small"},on:{click:function(t){e.$router.push({name:"BookingClassroom",params:{experiment_id:e.$route.params.id}})}}},[e._v("\n              "+e._s(e.common.checkAuthority("TestDetail_BookingClassroom")?e.common.checkAuthority("TestDetail_BookingClassroom").name:"")+"\n            ")])],1)],2):e._e(),e.common.checkAuthority("TestDetail_QueryExperimentalTaskMoudle",!0)?a("el-card",{staticClass:"mart20"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("实验任务")])]),e._l(e.taskListData.rows,function(t,s){return a("el-card",{key:s,staticClass:"mart5 cursor-pointer",staticStyle:{position:"relative"}},[a("p",{on:{click:function(a){e.goToTaskPape(t)}}},[4!=t.type?a("span",[e._v("\n            "+e._s(t.name)+"，满分： "+e._s(t.score)+"，总成绩占比："+e._s(t.value)+"% 。\n          ")]):a("span",[e._v("\n            "+e._s(t.name)+" 。\n          ")]),a("span",[e._v("状态："),a("span",{style:{color:e.reportStatus(t.cur_status).color}},[e._v(e._s(e.reportStatus(t.cur_status).name))])])]),a("el-button",{staticClass:"del-circle-btn",attrs:{disabled:!e.common.checkAuthority("TestDetail_DelelteTask",!0),type:"danger"},on:{click:function(a){e.deleteTask(t)}}},[e._v("\n              删除\n            ")])],1)}),a("p",{staticClass:"text-right"},[a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_AttendanceTask",!0)||!e.isExistTeacher,type:"primary",size:"small"},on:{click:function(t){e.attendanceTaskDialog=!0,e.$refs.attendanceTaskForm&&e.$refs.attendanceTaskForm.resetFields()}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_AttendanceTask")?e.common.checkAuthority("TestDetail_AttendanceTask").name:"")+"\n          ")]),a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_ReportTask",!0)||!e.isExistTeacher,type:"primary",size:"small"},on:{click:function(t){e.reportTaskDialog=!0,e.$refs.reportTaskForm&&e.$refs.reportTaskForm.resetFields(),e.$refs.baseTaskForm&&e.$refs.baseTaskForm.resetFields()}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_ReportTask")?e.common.checkAuthority("TestDetail_ReportTask").name:"")+"    \n          ")]),a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_ExerciseRequest",!0)||!e.isExistTeacher,type:"primary",size:"small"},on:{click:function(t){e.taskShow(1)}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_ExerciseRequest")?e.common.checkAuthority("TestDetail_ExerciseRequest").name:"")+"    \n          ")]),a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_CreateQuestionnaire",!0)||!e.isExistTeacher,type:"primary",size:"small"},on:{click:function(t){e.taskShow(4)}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_CreateQuestionnaire")?e.common.checkAuthority("TestDetail_CreateQuestionnaire").name:"")+"    \n          ")])],1)],2):e._e(),e.common.checkAuthority("TestDetail_QueryExperimentalMembersMoudle",!0)?a("el-card",{staticClass:"mart20"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("实验成员")])]),a("el-card",{attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("strong",[e._v("教师")])]),e.memeberCourseTeaherListData.rows.length?a("el-button",{staticClass:"fr",attrs:{disabled:!e.common.checkAuthority("TestDetail_AddTeacher",!0),type:"primary",size:"mini"},on:{click:function(t){e.addTeacherMember(2)}}},[e._v("\n                "+e._s(e.common.checkAuthority("TestDetail_AddTeacher")?e.common.checkAuthority("TestDetail_AddTeacher").name:"")+"\n              ")]):a("div",{staticClass:"fr coloCCC"},[e._v("\n              系统中没有可选课程教师角色的用户，请联系课程组长添加相应用户到课程！\n            ")])],1),a("div",[a("el-row",{staticClass:"padding-row"},e._l(e.memeberTypeListData.teachers,function(t,s){return a("el-col",{key:s,attrs:{span:6}},[a("el-card",{staticClass:"person-card-wrap-card"},[a("div",{staticClass:"person-card-wrap"},[a("el-dropdown",{staticClass:"person-card-wrap pad5"},[a("div",{staticClass:"img-photo-fix wh100"},[a("img",{attrs:{src:t.head_img?t.head_img:"默认图",onerror:e.defaultImg(t.sex)}})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-row",{staticClass:"mar5 member-info-fix"},[a("el-col",{attrs:{span:9}},[a("p",[a("img",{attrs:{src:t.head_img?t.head_img:"默认图",onerror:e.defaultImg(t.sex),width:"100px",height:"100px"}})])]),a("el-col",{attrs:{span:15}},[a("p",[e._v("姓名："+e._s(t.user_name?t.user_name:"无"))]),a("p",[e._v("工/学号："+e._s(t.account?t.account:"无"))]),a("p",[e._v("手机："+e._s(t.phone_num?t.phone_num:"无"))]),a("p",[e._v("院系："+e._s(t.facultyName?t.facultyName:"无"))]),a("p",[e._v("邮箱："+e._s(t.mail?t.mail:"无"))])])],1)],1)],1),a("div",{staticClass:"content"},[a("p",{staticClass:"marb5 mart0"},[e._v(e._s(t.user_name)+"  ")]),a("p",{staticClass:"a-line-ellipsis mart0 marb5"},[e._v(e._s(t.facultyName)+" ")]),a("p",{staticClass:"mart0 marb5 more-line-ellipsis"},[e._v(e._s(t.sim_desc))])])],1),a("el-button",{staticClass:"del-circle-btn",attrs:{disabled:!e.common.checkAuthority("TestDetail_DelelteMember",!0),type:"danger"},on:{click:function(a){e.deleteMember(t,2)}}},[e._v("\n                      删除\n                    ")])],1)],1)}))],1)]),a("el-card",{staticClass:"mart10",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("strong",[e._v("助教")])]),e.memeberCourseTutorsListData.rows.length?a("el-button",{staticClass:"fr",attrs:{disabled:!e.common.checkAuthority("TestDetail_AddTutor",!0),type:"primary",size:"mini"},on:{click:function(t){e.addTeacherMember(4)}}},[e._v("\n                "+e._s(e.common.checkAuthority("TestDetail_AddTutor")?e.common.checkAuthority("TestDetail_AddTutor").name:"")+"\n              ")]):a("div",{staticClass:"fr coloCCC"},[e._v("\n              系统中没有可选课程助教角色的用户，请联系课程组长添加相应用户到课程！\n            ")])],1),a("div",[a("el-row",{staticClass:"padding-row"},e._l(e.memeberTypeListData.tutors,function(t,s){return a("el-col",{key:s,attrs:{span:6}},[a("el-card",{staticClass:"person-card-wrap-card"},[a("div",{staticClass:"person-card-wrap"},[a("el-dropdown",{staticClass:"person-card-wrap pad5"},[a("div",{staticClass:"img-photo-fix wh100"},[a("img",{attrs:{src:t.head_img?t.head_img:"默认图",onerror:e.defaultImg(t.sex)}})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-row",{staticClass:"mar5 member-info-fix"},[a("el-col",{attrs:{span:9}},[a("p",[a("img",{attrs:{src:t.head_img?t.head_img:"默认图",onerror:e.defaultImg(t.sex),width:"100px",height:"100px"}})])]),a("el-col",{attrs:{span:15}},[a("p",[e._v("姓名："+e._s(t.user_name?t.user_name:"无"))]),a("p",[e._v("工/学号："+e._s(t.account?t.account:"无"))]),a("p",[e._v("手机："+e._s(t.phone_num?t.phone_num:"无"))]),a("p",[e._v("院系："+e._s(t.facultyName?t.facultyName:"无"))]),a("p",[e._v("邮箱："+e._s(t.mail?t.mail:"无"))])])],1)],1)],1),a("div",{staticClass:"content"},[a("p",{staticClass:"marb5 mart0"},[e._v(e._s(t.user_name)+"  ")]),a("p",{staticClass:"a-line-ellipsis mart0 marb5"},[e._v(e._s(t.facultyName)+" ")]),a("p",{staticClass:"mart0 marb5 more-line-ellipsis"},[e._v(e._s(t.sim_desc))])])],1),a("el-button",{staticClass:"del-circle-btn",attrs:{disabled:!e.common.checkAuthority("TestDetail_DelelteMember",!0),type:"danger"},on:{click:function(a){e.deleteMember(t,4)}}},[e._v("\n                      删除\n                    ")])],1)],1)}))],1)]),a("el-card",{staticClass:"mart10",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[a("strong",[e._v("学员")])]),a("el-button",{staticClass:"fr",attrs:{type:"primary",size:"mini"},on:{click:e.goToStudentResister}},[e._v("管理实验的学生名册")])],1),a("div",e._l(e.memeberTypeListData.students,function(t,s){return a("div",{key:s,staticClass:"person-group-wrap marb10"},[a("div",{staticClass:"person-group-item_t"},[e._v(e._s(t.teamName)+"：")]),e._l(t.cMembers,function(s,r){return r<=4||r>4&&t.isShowMore?a("div",{staticClass:"person-group-item_w mart10",staticStyle:{width:"60px!important"}},[a("el-dropdown",{attrs:{"hide-on-click":!1,placement:"bottom-start"}},[a("div",{staticClass:"img-photo-fix wh50"},[a("img",{attrs:{src:s.head_img?s.head_img:"默认图",onerror:e.defaultImg(s.sex),width:"40px",height:"40px"}})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-row",{staticClass:"mar5 member-info-fix"},[a("el-col",{attrs:{span:9}},[a("p",[a("img",{attrs:{src:s.head_img?s.head_img:"默认图",onerror:e.defaultImg(s.sex),width:"100px",height:"100px"}})])]),a("el-col",{attrs:{span:15}},[a("p",[e._v("姓名："+e._s(s.user_name?s.user_name:"无"))]),a("p",[e._v("工/学号："+e._s(s.account?s.account:"无"))]),a("p",[e._v("手机："+e._s(s.phone_num?s.phone_num:"无"))]),a("p",[e._v("院系："+e._s(s.facultyName?s.facultyName:"无"))]),a("p",[e._v("邮箱："+e._s(s.mail?s.mail:"无"))])])],1)],1)],1)],1):e._e()}),t.cMembers&&t.cMembers.length>5?a("el-button",{attrs:{size:"small"},on:{click:function(a){e.showMoreMember(t)}}},[e._v(e._s(t.isShowMore?"仅展示5条":"显示更多"))]):e._e()],2)}))]),a("p",{staticClass:"text-right"},[a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_AttendanceSheet",!0),type:"primary",size:"small"},on:{click:function(t){e.$router.push({name:"AttendanceSheet",params:{experiment_id:e.$route.params.id}})}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_AttendanceSheet")?e.common.checkAuthority("TestDetail_AttendanceSheet").name:"")+"    \n          ")]),a("el-button",{attrs:{disabled:!e.common.checkAuthority("TestDetail_ScheduleOfAchievements",!0),type:"primary",size:"small"},on:{click:function(t){e.$router.push({name:"ScheduleOfAchievements",params:{experiment_id:e.$route.params.id}})}}},[e._v("\n            "+e._s(e.common.checkAuthority("TestDetail_ScheduleOfAchievements")?e.common.checkAuthority("TestDetail_ScheduleOfAchievements").name:"")+" \n          ")])],1)],1):e._e(),e.common.checkAuthority("TestDetail_QueryMessageMoudle",!0)?a("el-card",{staticClass:"mart20"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("留言栏")])]),a("div",{staticClass:"message-box"},[e.messageListData.total>0?a("el-card",{staticClass:"marb5"},[e._l(e.messageListData.rows,function(t,s){return a("div",{key:s,staticClass:"pad5"},[a("div",{staticClass:"overflow-hidden"},[a("div",{staticClass:"img-photo-fix wh20 inline-block"},[a("img",{attrs:{src:t.head_img?t.head_img:"默认图",onerror:e.defaultImg(t.sex),width:"20px",height:"20px"}})]),e._v("\n                 \n                "),a("span",{staticClass:"inline-block"},[e._v(e._s(t.creatorName))]),a("div",{staticClass:"inline-block marl10"},[e._v("\n                  发表于"+e._s(e.common._convertDate(t.create_time,"yyyy年MM月dd日"))+"\n                ")])]),a("div",{staticClass:"content mar10 leave-msg-box"},[a("p",[e._v(e._s(t.info))])])])}),a("div",{staticClass:"pad5 padt10 text-right"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":e.pageNum,"page-size":e.pageSize,"page-sizes":[5,10,15],total:e.messageListData.total},on:{"size-change":e.pageSizeChange,"current-change":e.pageCurrentChange}})],1)],2):e._e(),e.userDetail&&e.common.checkAuthority("TestDetail_ReleaseMessage",!0)?a("el-card",{staticClass:"marb5"},[a("div",{staticClass:"pad5"},[a("div",[a("div",{staticClass:"img-photo-fix wh20 inline-block"},[a("img",{attrs:{src:e.userDetail.head_img?e.userDetail.head_img:"默认图",onerror:e.defaultImg(e.userDetail.sex),width:"20px",height:"20px"}})]),e._v("\n                 "+e._s(e.userDetail.user_name)+"\n              ")]),a("div",{staticClass:"content mar10"},[a("el-form",{ref:"messageForm",attrs:{model:e.messageForm}},[a("el-form-item",{attrs:{prop:"info",rules:[{required:!0,message:"留言不能为空",trigger:""},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"请填写留言信息",type:"textarea"},model:{value:e.messageForm.info,callback:function(t){e.$set(e.messageForm,"info",t)},expression:"messageForm.info"}})],1)],1)],1),a("div",{staticClass:"text-right"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.submitMessage("messageForm")}}},[e._v("\n                  "+e._s(e.common.checkAuthority("TestDetail_ReleaseMessage")?e.common.checkAuthority("TestDetail_ReleaseMessage").name:"")+"\n                ")])],1)])]):e._e()],1)]):e._e()],1)]),a("el-dialog",{attrs:{width:"550px",title:"编辑实验基本信息",visible:e.editTestDialog},on:{"update:visible":function(t){e.editTestDialog=t}}},[a("el-form",{ref:"submitForm",attrs:{model:e.submitForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"实验名称：",prop:"name",rules:[{required:!0,message:"请输入实验名称",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"single")},trigger:"blur"}]}},[a("el-input",{model:{value:e.submitForm.name,callback:function(t){e.$set(e.submitForm,"name",t)},expression:"submitForm.name"}})],1),a("el-form-item",{attrs:{label:"实验简介：",prop:"description",rules:[{required:!0,message:"请输入实验简介",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.submitForm.description,callback:function(t){e.$set(e.submitForm,"description",t)},expression:"submitForm.description"}})],1),a("el-form-item",{attrs:{label:"得分占比：",prop:"value",rules:[{required:!0,message:"请输入得分占比",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1,max:100},model:{value:e.submitForm.value,callback:function(t){e.$set(e.submitForm,"value",t)},expression:"submitForm.value"}}),e._v(" %\n          ")],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editTestDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitTest("submitForm")}}},[e._v("保存")])],1)],1),a("el-dialog",{attrs:{width:"70vw",title:"添加成员",visible:e.memberDialog},on:{"update:visible":function(t){e.memberDialog=t}}},[a("el-form",{ref:"memberSearchForm",attrs:{inline:!0,model:e.memberSearchForm,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"姓名：",prop:"name"}},[a("el-input",{model:{value:e.memberSearchForm.user_name,callback:function(t){e.$set(e.memberSearchForm,"user_name",t)},expression:"memberSearchForm.user_name"}})],1),a("el-form-item",{attrs:{label:"工号：",prop:"account"}},[a("el-input",{model:{value:e.memberSearchForm.account,callback:function(t){e.$set(e.memberSearchForm,"account",t)},expression:"memberSearchForm.account"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getQueryMemberListByCourseId(e.memberBatchForm.type)}}},[e._v("搜索")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.$refs.memberSearchForm&&e.$refs.memberSearchForm.resetFields()}}},[e._v("置空")])],1)],1),a("el-table",{ref:"memberTable",staticStyle:{width:"100%"},attrs:{border:"","row-key":e.getTableRowKeys,data:e.memberListData.rows,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{"reserve-selection":!0,align:"center",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:"工号",prop:"account"}}),a("el-table-column",{attrs:{align:"center",prop:"user_name",label:"姓名"}}),a("el-table-column",{attrs:{align:"center",prop:"facultyName",label:"系别","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",prop:"phone_num",label:"手机","show-overflow-tooltip":""}})],1),a("div",{staticClass:"pad10"},[a("el-pagination",{staticClass:"fr ",attrs:{background:"","current-page":e.common.elementPagination.pageNum,"page-sizes":e.common.elementPagination.pageSizes,"page-size":e.common.elementPagination.pageSizeDefault,layout:"total, sizes, prev, pager, next",total:e.memberListData.total},on:{"size-change":function(t){e.handleSizeChange(t)},"current-change":function(t){e.handleCurrentChange(t)}}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.memberDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitBatch("memberBatchForm")}}},[e._v("保存")])],1)],1),e.detailData?a("el-dialog",{attrs:{width:"550px",title:"创建报告要求",visible:e.reportTaskDialog},on:{"update:visible":function(t){e.reportTaskDialog=t}}},[e.detailData.template&&e.baseReportTaskList.rows.length?a("el-tabs",{model:{value:e.activeBaseName,callback:function(t){e.activeBaseName=t},expression:"activeBaseName"}},[a("el-tab-pane",{attrs:{label:"自定义",name:"1"}},[a("el-form",{ref:"reportTaskForm",attrs:{model:e.reportTaskForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称：",prop:"name",rules:[{required:!0,message:"请输入任务名称",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"single")},trigger:"blur"}]}},[a("el-input",{model:{value:e.reportTaskForm.name,callback:function(t){e.$set(e.reportTaskForm,"name",t)},expression:"reportTaskForm.name"}})],1),a("el-form-item",{attrs:{label:"截止日期：",prop:"end_time",rules:[{required:!0,message:"请选择截止日期",trigger:"blur"}]}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.reportTaskForm.end_time,callback:function(t){e.$set(e.reportTaskForm,"end_time",t)},expression:"reportTaskForm.end_time"}})],1),a("el-form-item",{attrs:{label:"得分占比：",prop:"value",rules:[{required:!0,message:"请输入得分占比",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1,max:100},model:{value:e.reportTaskForm.value,callback:function(t){e.$set(e.reportTaskForm,"value",t)},expression:"reportTaskForm.value"}}),e._v(" %\n            ")],1),a("el-form-item",{attrs:{label:"总分：",prop:"score",rules:[{required:!0,message:"请输入总分",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1},model:{value:e.reportTaskForm.score,callback:function(t){e.$set(e.reportTaskForm,"score",t)},expression:"reportTaskForm.score"}})],1),a("el-form-item",{attrs:{label:"报告类型：",prop:"genre",rules:[{required:!0,message:"请选择报告类型",trigger:"blur"}]}},[a("el-radio-group",{model:{value:e.reportTaskForm.genre,callback:function(t){e.$set(e.reportTaskForm,"genre",t)},expression:"reportTaskForm.genre"}},[a("el-radio",{attrs:{label:1}},[e._v("小组报告")]),a("el-radio",{attrs:{label:2}},[e._v("个人报告")])],1)],1),a("el-form-item",{attrs:{label:"报告模板：",prop:"task_files",rules:[{required:!1,message:"请选择报告模板",trigger:"blur"}]}},[a("upload",{attrs:{buttonText:"上传"},on:{uploadSuccess:e.uploadReportSuccess}}),a("span",[e._v(e._s(e.reportTaskForm.task_files?JSON.parse(e.reportTaskForm.task_files).name:""))])],1),a("el-form-item",{attrs:{label:"报告要求：",prop:"description",rules:[{required:!0,message:"请输入报告要求",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.reportTaskForm.description,callback:function(t){e.$set(e.reportTaskForm,"description",t)},expression:"reportTaskForm.description"}})],1)],1)],1),a("el-tab-pane",{attrs:{label:"模板",name:"2"}},[a("el-form",{ref:"baseTaskForm",attrs:{model:e.baseTaskForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板：",prop:"tasks",rules:[{required:!0,message:"请选择模板",trigger:"blur"}]}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.baseTaskForm.tasks,callback:function(t){e.$set(e.baseTaskForm,"tasks",t)},expression:"baseTaskForm.tasks"}},e._l(e.baseReportTaskList.rows,function(e,t){return a("el-option",{attrs:{value:e.id,label:e.name}})}))],1)],1)],1)],1):a("el-form",{ref:"reportTaskForm",attrs:{model:e.reportTaskForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称：",prop:"name",rules:[{required:!0,message:"请输入任务名称",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"single")},trigger:"blur"}]}},[a("el-input",{model:{value:e.reportTaskForm.name,callback:function(t){e.$set(e.reportTaskForm,"name",t)},expression:"reportTaskForm.name"}})],1),a("el-form-item",{attrs:{label:"截止日期：",prop:"end_time",rules:[{required:!0,message:"请选择截止日期",trigger:"blur"}]}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.reportTaskForm.end_time,callback:function(t){e.$set(e.reportTaskForm,"end_time",t)},expression:"reportTaskForm.end_time"}})],1),a("el-form-item",{attrs:{label:"得分占比：",prop:"value",rules:[{required:!0,message:"请输入得分占比",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1,max:100},model:{value:e.reportTaskForm.value,callback:function(t){e.$set(e.reportTaskForm,"value",t)},expression:"reportTaskForm.value"}}),e._v(" %\n        ")],1),a("el-form-item",{attrs:{label:"总分：",prop:"score",rules:[{required:!0,message:"请输入总分",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1},model:{value:e.reportTaskForm.score,callback:function(t){e.$set(e.reportTaskForm,"score",t)},expression:"reportTaskForm.score"}})],1),a("el-form-item",{attrs:{label:"报告类型：",prop:"genre",rules:[{required:!0,message:"请选择报告类型",trigger:"blur"}]}},[a("el-radio-group",{model:{value:e.reportTaskForm.genre,callback:function(t){e.$set(e.reportTaskForm,"genre",t)},expression:"reportTaskForm.genre"}},[a("el-radio",{attrs:{label:1}},[e._v("小组报告")]),a("el-radio",{attrs:{label:2}},[e._v("个人报告")])],1)],1),a("el-form-item",{attrs:{label:"报告模板：",prop:"task_files",rules:[{required:!1,message:"请选择报告模板",trigger:"blur"}]}},[a("upload",{attrs:{buttonText:"上传"},on:{uploadSuccess:e.uploadReportSuccess}}),a("span",[e._v(e._s(e.reportTaskForm.task_files?JSON.parse(e.reportTaskForm.task_files).name:""))])],1),a("el-form-item",{attrs:{label:"报告要求：",prop:"description",rules:[{required:!0,message:"请输入报告要求",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.reportTaskForm.description,callback:function(t){e.$set(e.reportTaskForm,"description",t)},expression:"reportTaskForm.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.reportTaskDialog=!1}}},[e._v("取 消")]),1==e.activeBaseName?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitReport("reportTaskForm")}}},[e._v("保存")]):e._e(),2==e.activeBaseName?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitBase("baseTaskForm")}}},[e._v("保存")]):e._e()],1)],1):e._e(),a("el-dialog",{attrs:{width:"550px",title:"创建考勤任务",visible:e.attendanceTaskDialog},on:{"update:visible":function(t){e.attendanceTaskDialog=t}}},[a("el-form",{ref:"attendanceTaskForm",attrs:{model:e.attendanceTaskForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称：",prop:"name",rules:[{required:!0,message:"请输入任务名称",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"single")},trigger:"blur"}]}},[a("el-input",{model:{value:e.attendanceTaskForm.name,callback:function(t){e.$set(e.attendanceTaskForm,"name",t)},expression:"attendanceTaskForm.name"}})],1),a("el-form-item",{attrs:{label:"总分：",prop:"score",rules:[{required:!0,message:"请输入总分",trigger:"blur"}]}},[a("el-input-number",{attrs:{min:1,type:"number"},model:{value:e.attendanceTaskForm.score,callback:function(t){e.$set(e.attendanceTaskForm,"score",t)},expression:"attendanceTaskForm.score"}})],1),a("el-form-item",{attrs:{label:"得分占比：",prop:"value",rules:[{required:!0,message:"请输入得分占比",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1,max:100},model:{value:e.attendanceTaskForm.value,callback:function(t){e.$set(e.attendanceTaskForm,"value",t)},expression:"attendanceTaskForm.value"}}),e._v(" %\n        ")],1),a("el-form-item",{attrs:{label:"任务描述：",prop:"description",rules:[{required:!0,message:"请输入任务描述",trigger:"blur"},{validator:function(t,a,s){e.common.wordNumberValid(t,a,s,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:e.attendanceTaskForm.description,callback:function(t){e.$set(e.attendanceTaskForm,"description",t)},expression:"attendanceTaskForm.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.attendanceTaskDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitAttendance("attendanceTaskForm")}}},[e._v("保存")])],1)],1),a("el-dialog",{attrs:{width:"80vw",title:"补录课时",visible:e.supplementClassDialog},on:{"update:visible":function(t){e.supplementClassDialog=t}}},[a("div",{staticClass:"router-view-content"},[a("el-card",{staticClass:"box-card mart20"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[e._v("预约教室")])]),a("el-form",{ref:"supplementClassForm",attrs:{model:e.supplementClassForm,inline:!0,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"实验室：",prop:"id"}},[a("el-select",{model:{value:e.supplementClassForm.id,callback:function(t){e.$set(e.supplementClassForm,"id",t)},expression:"supplementClassForm.id"}},e._l(e.labList.rows,function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.name}})}))],1),a("el-form-item",{attrs:{label:"预约节次：",prop:"sTime",rules:[{required:!0,message:"请选择第一个时间",trigger:"blur"},{validator:function(t,a,s){e.dateValid(t,a,s,"sTime")},trigger:"blur"}]}},[a("el-date-picker",{attrs:{type:"date"},model:{value:e.supplementClassForm.sTime,callback:function(t){e.$set(e.supplementClassForm,"sTime",t)},expression:"supplementClassForm.sTime"}})],1),a("el-form-item",{attrs:{prop:"b_index",rules:[{required:!0,message:"请选择第一个时间的节次",trigger:"blur"},{validator:function(t,a,s){e.indexValid(t,a,s,"b_index")},trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1},model:{value:e.supplementClassForm.b_index,callback:function(t){e.$set(e.supplementClassForm,"b_index",t)},expression:"supplementClassForm.b_index"}})],1),a("el-form-item",[e._v("\n            ~\n          ")]),a("el-form-item",{attrs:{prop:"eTime",rules:[{required:!0,message:"请选择第二个时间",trigger:"blur"}]}},[a("el-date-picker",{attrs:{type:"date"},model:{value:e.supplementClassForm.eTime,callback:function(t){e.$set(e.supplementClassForm,"eTime",t)},expression:"supplementClassForm.eTime"}})],1),a("el-form-item",{attrs:{prop:"e_index",rules:[{required:!0,message:"请选择第二个时间的节次",trigger:"blur"},{validator:function(t,a,s){e.indexValid(t,a,s,"e_index")},trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1},model:{value:e.supplementClassForm.e_index,callback:function(t){e.$set(e.supplementClassForm,"e_index",t)},expression:"supplementClassForm.e_index"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getQuerySelectClass("supplementClassForm")}}},[e._v("\n              查询\n            ")])],1)],1),a("el-row",{staticClass:"padding-row"},e._l(e.selectClassData,function(t,s){return a("el-col",{key:s,attrs:{span:8}},[a("el-card",{staticClass:"card-class marl10"},[a("p",[a("el-checkbox",{staticClass:"fl marr10",attrs:{disabled:!!t.timeTableRecord&&!t.timeTableRecord.l_bespeak_id},model:{value:t.isChecked,callback:function(a){e.$set(t,"isChecked",a)},expression:"item.isChecked"}}),a("span",{staticClass:"fl"},[e._v("容量："+e._s(t.size)+" ")])],1),a("br"),a("p",[e._v("教室地址："+e._s(t.address))]),t.timeTableRecord&&!t.timeTableRecord.l_bespeak_id?a("div",{staticStyle:{color:"#c7a53d"}},[e._v(" \n                已被实验室占用，不能再强行预约\n              ")]):e._e(),t.timeTableRecord&&t.timeTableRecord.l_bespeak_id?a("div",[a("p",[e._v(e._s(t.timeTableRecord.faculty_name)+" 的 "+e._s(t.timeTableRecord.user_name)+" 在 "+e._s(t.timeTableRecord.experiment_name)+" 下占用了该教室")]),a("p",[e._v("占用人联系电话："+e._s(t.timeTableRecord.phone_num))])]):e._e()])],1)})),a("div",{staticClass:"text-right mart10"},[a("el-button",{attrs:{type:"primary"},on:{click:e.reserveClass}},[e._v("\n            补录\n          ")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.attendanceTaskDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitAttendance("attendanceTaskForm")}}},[e._v("保存")])],1)]),e.detailData?a("el-dialog",{attrs:{width:"550px",title:1==e.baseTaskType?"添加习题要求":"添加评价要求",visible:e.baseTaskDialog},on:{"update:visible":function(t){e.baseTaskDialog=t}}},[e.detailData.template&&e.baseReportTaskList.rows.length?a("el-tabs",{model:{value:e.activeEBaseName,callback:function(t){e.activeEBaseName=t},expression:"activeEBaseName"}},[a("el-tab-pane",{attrs:{label:"自定义",name:"1"}},[1==e.baseTaskType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.$router.push({name:"ExerciseRequest",params:{id:e.$route.params.id}})}}},[e._v("跳到自定义")]):e._e(),4==e.baseTaskType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.$router.push({name:"CreateQuestionnaire",params:{id:e.$route.params.id}})}}},[e._v("跳到自定义")]):e._e()],1),a("el-tab-pane",{attrs:{label:"模板",name:"2"}},[a("el-form",{ref:"baseTaskForm",attrs:{model:e.baseTaskForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板：",prop:"tasks",rules:[{required:!0,message:"请选择模板",trigger:"blur"}]}},[1==e.baseTaskType?a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.baseTaskForm.tasks,callback:function(t){e.$set(e.baseTaskForm,"tasks",t)},expression:"baseTaskForm.tasks"}},e._l(e.baseExercisesTaskList.rows,function(e,t){return a("el-option",{attrs:{value:e.id,label:e.name}})})):e._e(),4==e.baseTaskType?a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.baseTaskForm.tasks,callback:function(t){e.$set(e.baseTaskForm,"tasks",t)},expression:"baseTaskForm.tasks"}},e._l(e.baseEvaluateTaskList.rows,function(e,t){return a("el-option",{attrs:{value:e.id,label:e.name}})})):e._e()],1)],1)],1)],1):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.baseTaskDialog=!1}}},[e._v("取 消")]),2==e.activeEBaseName?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitBase("baseTaskForm")}}},[e._v("保存")]):e._e()],1)],1):e._e()],1)},r=[],i=(a("ac6a"),a("7f7f"),a("cadf"),a("551c"),a("097d"),a("d443")),o={data:function(){return{paramId:this.$route.params.id,detailData:null,activeBaseName:"1",activeEBaseName:"1",showModel:"main",userDetail:null,baseTaskType:1,isExistTeacher:!1,memeberTypeListData:{groupLeaders:[],students:[],teachers:[],tutors:[]},surplusTotalScore:0,lBespeakRecordListData:{total:0,rows:[]},memeberCourseStudentListData:{total:0,rows:[]},memeberCourseTeaherListData:{total:0,rows:[]},memeberCourseTutorsListData:{total:0,rows:[]},labList:{rows:[],total:0},supplementClassDialog:!1,memberDialog:!1,editTestDialog:!1,reportTaskDialog:!1,baseTaskDialog:!1,attendanceTaskDialog:!1,memberSearchForm:{experiment_id:this.$route.params.id,user_name:null,account:null,pageNum:this.common.elementPagination.pageNumDefault,pageSize:this.common.elementPagination.pageSizeDefault},memberListData:{total:0,rows:[]},messageListData:{total:0,rows:[]},selectClassData:[],memberBatchForm:{experiment_id:this.$route.params.id,type:2,member_id:[]},submitForm:{name:null,description:null,etype:null,course_id:null,value:null},taskListData:{total:0,rows:[]},baseReportTaskList:{total:0,rows:[]},baseExercisesTaskList:{total:0,rows:[]},baseEvaluateTaskList:{total:0,rows:[]},reportTaskForm:{experiment_id:this.$route.params.id,name:null,value:null,score:null,end_time:null,description:null,genre:null,task_files:null},baseTaskForm:{experimentID:this.$route.params.id,tasks:null,defaultValue:null},attendanceTaskForm:{experiment_id:this.$route.params.id,name:null,value:null,score:null,type:3,is_block:null,description:null},messageForm:{info:null,associated_object:this.$route.params.id,type:2},supplementClassForm:{sTime:new Date,eTime:new Date,b_index:1,e_index:2,id:null},pageNum:1,pageSize:5}},components:{upload:i["a"]},computed:{reportStatus:function(){return function(e){switch(e){case 1:return{name:"未发布",color:"#f5b800"};case 2:return{name:"进行中",color:"#d298fd"};case 3:return{name:"已截止",color:"red"};case 4:return{name:"已结束",color:"#3aff6e"}}}}},mounted:function(){this.getQueryDetail(),this.getQueryMemberListType(),this.getQueryFaculty(),this.getQueryTaskList(),this.getMessageList(),this.getUserDetail(),this.getLBespeakRecordList(),this.getQuerylabList(),this.loginAccountIsRole()},methods:{upGradeBase:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/baseExperiment/upgrade"),{params:{experimentID:this.paramId}}).then(function(t){e.$message.success(t.data.meta.message),e.getQueryDetail()}).catch(function(t){e.$message.error(t)})},getQueryBaseList:function(e){var t=this;this.axios.get("".concat(this.common.basePath,"/baseTask"),{params:{experiment_id:this.detailData.template,type:e,cur_status:1}}).then(function(a){1==e?t.baseExercisesTaskList=a.data.data:2==e?t.baseReportTaskList=a.data.data:4==e&&(t.baseEvaluateTaskList=a.data.data)}).catch(function(e){t.$message.error(e)})},pageSizeChange:function(e){this.pageSize=e,this.getMessageList()},pageCurrentChange:function(e){this.pageNum=e,this.getMessageList()},defaultImg:function(e){return 1==e?'this.src="'+a("e93b")+'"':'this.src="'+a("e0a3")+'"'},dateValid:function(e,t,a,s){this.common._convertDate(this.supplementClassForm.sTime,"yyyyMMdd")>this.common._convertDate(this.supplementClassForm.eTime,"yyyyMMdd")?a(new Error("第一个时间不能大于第二个时间")):a()},indexValid:function(e,t,a,s){t>14&&a(new Error("最大节不能大于14")),this.supplementClassForm.b_index>this.supplementClassForm.e_index?a(new Error("第一个节次不能大于第二个节次")):a()},getQueryDetail:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/experiment/").concat(this.paramId),"").then(function(t){e.detailData=t.data.data,e.submitForm.name=t.data.data.name,e.submitForm.description=t.data.data.description,e.submitForm.etype=t.data.data.etype,e.submitForm.course_id=t.data.data.course_id,e.submitForm.value=t.data.data.value,e.getQueryMemberListByCourseId(2),e.getQueryMemberListByCourseId(3),e.getQueryMemberListByCourseId(4),e.detailData.template&&(e.getQueryBaseList(1),e.getQueryBaseList(2),e.getQueryBaseList(4))}).catch(function(t){e.$message.error(t)})},getUserDetail:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/user/one/user"),{params:{id:sessionStorage.getItem("Access-Key")}}).then(function(t){e.userDetail=t.data.data}).catch(function(t){e.$message.error(t)})},getLBespeakRecordList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/l_bespeak_record/list/").concat(this.$route.params.id),"").then(function(t){e.lBespeakRecordListData=t.data.data}).catch(function(t){e.$message.error(t)})},getQueryMemberListByCourseId:function(e){var t=this;this.axios.get("".concat(this.common.basePath,"/member"),this._memberListByCourseIdParams(e)).then(function(a){2==e?t.memberListData=t.memeberCourseTeaherListData=a.data.data:3==e?t.memberListData=t.memeberCourseStudentListData=a.data.data:4==e&&(t.memberListData=t.memeberCourseTutorsListData=a.data.data)}).catch(function(e){t.$message.error(e)})},_memberListByCourseIdParams:function(e){var t=JSON.parse(JSON.stringify(this.memberSearchForm));return t.type=e,t.course_id=this.detailData.course_id,{params:t}},getQueryMemberListType:function(){var e=this;this.axios.post("".concat(this.common.basePath,"/participant/members/type"),{types:[2,4],experiment_id:this.$route.params.id}).then(function(t){e.memeberTypeListData.groupLeaders=t.data.data.groupLeaders,e.memeberTypeListData.teachers=t.data.data.teachers,e.memeberTypeListData.tutors=t.data.data.tutors}).catch(function(t){e.$message.error(t)})},getQueryFaculty:function(){var e=this;this.axios.post("".concat(this.common.basePath,"/participant/members/group"),{types:[3],experiment_id:this.$route.params.id}).then(function(t){e.memeberTypeListData.students=e._studensData(t.data.data)}).catch(function(t){e.$message.error(t)})},_studensData:function(e){if(!e)return[];var t=[];for(var a in e)t.push({teamName:a,cMembers:e[a],isShowMore:!1});return t},getQuerylabList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/lab/list"),"").then(function(t){e.labList=t.data.data,e.supplementClassForm.id=e.labList.rows&&e.labList.rows.length?e.labList.rows[0].id:null}).catch(function(t){e.$message.error(t)})},getQuerySelectClass:function(e){var t=this;e?this.$refs[e].validate(function(e){if(!e)return!1;t._selectClassAxios()}):this._selectClassAxios()},_selectClassParams:function(){return{sTime:this.supplementClassForm.sTime?this.supplementClassForm.sTime.getTime():null,eTime:this.supplementClassForm.eTime?this.supplementClassForm.eTime.getTime():null,b_index:this.supplementClassForm.b_index,e_index:this.supplementClassForm.e_index,id:this.supplementClassForm.id,size:this.supplementClassForm.size}},_selectClassAxios:function(){var e=this;this.axios.post("".concat(this.common.basePath,"/lab/select/class"),this._selectClassParams()).then(function(t){e.selectClassData=e._selectClassDataAddKey(t.data.data)}).catch(function(t){e.$message.error(t)})},_selectClassDataAddKey:function(e){return e.forEach(function(e){e.isChecked=!1}),e},addTeacherMember:function(e){this.memberListData=2==e?this.memeberCourseTeaherListData:this.memeberCourseTutorsListData,this.memberDialog=!0,this.memberBatchForm.type=e,this.$refs.memberSearchForm&&this.$refs.memberSearchForm.resetFields(),this.getQueryMemberListByCourseId(e),this.$refs.memberTable&&this.$refs.memberTable.clearSelection()},addStudentMember:function(e){this.memberListData=this.memeberCourseStudentListData,this.memberDialog=!0,this.memberBatchForm.group_num=e,this.memberBatchForm.type=3,this.$refs.memberSearchForm&&this.$refs.memberSearchForm.resetFields(),this.getQueryMemberListByCourseId(3),this.$refs.memberTable&&this.$refs.memberTable.clearSelection()},handleSelectionChange:function(e){var t=this;this.memberBatchForm.member_id=[],e.forEach(function(e){t.memberBatchForm.member_id.push(e.id)})},getTableRowKeys:function(e){return e.id},submitBatch:function(){var e=this;if(!this.memberBatchForm.member_id.length)return this.$message.error("请选择成员"),!1;this.axios.post("".concat(this.common.basePath,"/participant/add/batch"),this.memberBatchForm).then(function(t){3!=e.memberBatchForm.type?e.getQueryMemberListType():e.getQueryFaculty(),e.getQueryMemberListByCourseId(e.memberBatchForm.type),e.memberDialog=!1,e.$message.success(t.data.meta.message),e.loginAccountIsRole()}).catch(function(t){e.$message.error(t),e.memberDialog=!1,e.loginAccountIsRole()})},submitTest:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.axios.patch("".concat(t.common.basePath,"/experiment/").concat(t.paramId),t.submitForm).then(function(e){t.getQueryDetail(!0),t.editTestDialog=!1,t.$message.success(e.data.meta.message)}).catch(function(e){t.$message.error(e),t.editTestDialog=!1})})},submitReport:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.axios.post("".concat(t.common.basePath,"/task/save/report"),t.reportTaskForm).then(function(e){t.getQueryTaskList(),t.reportTaskDialog=!1,t.$message.success(e.data.meta.message)}).catch(function(e){t.$message.error(e),t.reportTaskDialog=!1})})},submitBase:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.axios.post("".concat(t.common.basePath,"/baseTask/build"),t.baseTaskForm).then(function(e){t.getQueryTaskList(),t.reportTaskDialog=!1,t.baseTaskDialog=!1,t.$message.success(e.data.meta.message)}).catch(function(e){t.$message.error(e),t.reportTaskDialog=!1,t.baseTaskDialog=!1})})},getQueryTaskList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/task"),{params:{experiment_id:this.$route.params.id}}).then(function(t){e.taskListData=t.data.data,e._totalScore(t.data.data)}).catch(function(t){e.$message.error(t)})},_totalScore:function(e){var t=this;if(e){var a=0;e.rows&&(e.rows.forEach(function(e){t.totalScore+=parseInt(e.score)}),this.surplusTotalScore=100-a)}},goToTaskPape:function(e){switch(e.type){case 1:this.$router.push({name:"ExercisesTaskDetail",params:{experiment_id:this.$route.params.id,task_id:e.id}});break;case 2:this.$router.push({name:"ReportDetail",params:{id:e.id}});break;case 3:this.$router.push({name:"AttendanceTaskDetail",params:{task_id:e.id,experiment_id:this.$route.params.id}});break;case 4:this.$router.push({name:"QuestionnaireTaskDetail",params:{id:e.id}});break}},submitAttendance:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.axios.post("".concat(t.common.basePath,"/task"),t.attendanceTaskForm).then(function(e){t.getQueryTaskList(),t.attendanceTaskDialog=!1,t.$message.success(e.data.meta.message)}).catch(function(e){t.$message.error(e),t.attendanceTaskDialog=!1})})},getMessageList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/m_massage"),{params:{associated_object:this.$route.params.id,type:2,pageSize:this.pageSize,pageNum:this.pageNum}}).then(function(t){e.messageListData=t.data.data}).catch(function(t){e.$message.error(t)})},submitMessage:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;t.axios.post("".concat(t.common.basePath,"/m_massage"),t.messageForm).then(function(a){t.getMessageList(),t.$refs[e].resetFields(),t.$message.success(a.data.meta.message)}).catch(function(e){t.$message.error(e),t.messageForm.info=null})})},handleTagClose:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.axios.delete("".concat(t.common.basePath,"/c_literature/").concat(e.id),"").then(function(e){t.$message.success(e.data.meta.message),t.getQueryDetail()}).catch(function(e){t.$message.error(e)})}).catch(function(){})},uploadSuccess:function(e,t){var a=this,s=3,r={name:t.name,path:t.path,associated_object:this.$route.params.id,ao_type:s};this.axios.post("".concat(this.common.basePath,"/c_literature"),r).then(function(e){a.getQueryDetail()}).catch(function(e){a.$message.error(e)})},deleteLBespeakRecord:function(e){var t=this;this.axios.delete("".concat(this.common.basePath,"/l_bespeak_record/reject/").concat(e),"").then(function(e){t.$message.success(e.data.meta.message),t.getLBespeakRecordList()}).catch(function(e){t.$message.error(e)})},deleteMember:function(e,t){var a=this;this.axios.patch("".concat(this.common.basePath,"/participant/delete/").concat(e.id),"").then(function(e){3==t?a.getQueryFaculty():a.getQueryMemberListType(),a.getQueryMemberListByCourseId(t),a.$message.success(e.data.meta.message),a.loginAccountIsRole()}).catch(function(e){a.$message.error(e)})},handleCurrentChange:function(e,t){this.memberSearchForm.pageNum=e,this.getQueryMemberListByCourseId(this.memberBatchForm.type)},handleSizeChange:function(e,t){this.memberSearchForm.pageSize=e,this.getQueryMemberListByCourseId(this.memberBatchForm.type)},uploadReportSuccess:function(e){this.reportTaskForm.task_files=JSON.stringify(e)},deleteTask:function(e){var t=this;this.$confirm("确认删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.axios.patch("".concat(t.common.basePath,"/task/delete/").concat(e.id),"").then(function(e){t.$message.success(e.data.meta.message),t.getQueryTaskList()}).catch(function(e){t.$message.error(e)})}).catch(function(){})},supplementClassShow:function(){this.supplementClassDialog=!0,this.getQuerySelectClass()},reserveClass:function(){var e=this;if(this.ids=[],this.selectClassData.forEach(function(t){t.isChecked&&e.ids.push(t.id)}),!this.ids.length)return this.$message.warning("请选择要预约的教室"),!1;var t={ids:this.ids,sTime:this.supplementClassForm.sTime,eTime:this.supplementClassForm.eTime,b_index:this.supplementClassForm.b_index,e_index:this.supplementClassForm.e_index,reason:"无",experiment_id:this.$route.params.id,owner_id:sessionStorage.getItem("Access-Key")};this.axios.post("".concat(this.common.basePath,"//lab/reserve/repair"),t).then(function(t){e.$message.success(t.data.meta.message),e.getLBespeakRecordList(),e.supplementClassDialog=!1}).catch(function(t){e.$message.error(t)})},showMoreMember:function(e){e.isShowMore=!e.isShowMore},goToStudentResister:function(){1==this.detailData.etype?this.$router.push({name:"TestPersonalStudentResister",params:{id:this.paramId,courseId:this.detailData.course_id}}):this.$router.push({name:"TestGroupStudentResister",params:{id:this.paramId,courseId:this.detailData.course_id}})},loginAccountIsRole:function(){var e=this;this.isExistTeacher=!1,this.axios.get("".concat(this.common.basePath,"/participant/type"),{params:{experiment_id:this.paramId}}).then(function(t){t.data.data&&t.data.data.forEach(function(t){"2"!=t&&"4"!=t||(e.isExistTeacher=!0)})}).catch(function(t){e.$message.error(t)})},taskShow:function(e){this.$refs.baseTaskForm&&this.$refs.baseTaskForm.resetFields();var t=this.detailData.template;if(this.baseTaskType=e,t){if(!this.baseExercisesTaskList.rows.length&&1==e)return this.$router.push({name:"ExerciseRequest",params:{id:this.$route.params.id}});if(!this.baseEvaluateTaskList.rows.length&&4==e)return this.$router.push({name:"CreateQuestionnaire",params:{id:this.$route.params.id}});this.baseTaskDialog=!0}else 1==e?this.$router.push({name:"ExerciseRequest",params:{id:this.$route.params.id}}):4==e&&this.$router.push({name:"CreateQuestionnaire",params:{id:this.$route.params.id}})}}},n=o,l=(a("7bfb"),a("2877")),m=Object(l["a"])(n,s,r,!1,null,null,null);m.options.__file="TestDetail.vue";t["default"]=m.exports},dec0:function(e,t,a){}}]);
//# sourceMappingURL=chunk-1c35.d839554c.js.map