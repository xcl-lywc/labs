(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61e2"],{"243d":function(t,e,a){},"4e03":function(t,e,a){"use strict";var r=a("243d"),s=a.n(r);s.a},"71fb":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/eptmanage/reporttasklist"}}},[t._v("待提交报告列表")]),a("el-breadcrumb-item",[t._v("报告详情")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoad,expression:"isLoad"}],staticClass:"router-view-wrap transparent-bg"},[a("div",{staticClass:"router-view-content task-detail"},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[t._v("课程信息")])]),t.courseDetail?a("el-row",[a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            课程名称："+t._s(t.courseDetail.name)+" \n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            课程代码： "+t._s(t.courseDetail.c_code)+"\n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            课程教师： "+t._s(t.courseDetail.c_teacher)+"\n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            课程性质： "+t._s(t.courseDetail.c_nature)+"\n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            简介："+t._s(t.courseDetail.description)+" \n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            课程组长："),t._l(t.courseDetail.courseLeader,function(e,r){return a("span",{key:r},[t._v(t._s(e.user_name)+"，")])})],2),a("el-col",{staticClass:"marb5",attrs:{span:12}},[t._v("\n            创建时间："+t._s(t.common._convertDate(t.courseDetail.create_time,"yyyy年MM月dd日"))+"  \n          ")])],1):t._e()],1),a("el-card",{staticClass:"mart20"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[t._v("实验信息")])]),t.experimentDetail?a("el-row",[a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            实验名称："+t._s(t.experimentDetail.name)+"  \n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            简介："+t._s(t.experimentDetail.description)+" \n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            任课教师："),t._l(t.experimentDetail.teacher,function(e,r){return a("span",{key:r},[t._v(t._s(e.user_name)+"，")])})],2),a("el-col",{staticClass:"marb5",attrs:{span:12}},[t._v("\n            创建时间："+t._s(t.common._convertDate(t.experimentDetail.create_time,"yyyy年MM月dd日"))+"  \n          ")])],1):t._e()],1),a("el-card",{staticClass:"mart20"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"card-title"},[t._v("任务信息")])]),t.taskDetail?a("el-row",[a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            报告名称："+t._s(t.taskDetail.name)+" \n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            得分占比："+t._s(t.taskDetail.value)+"%\n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            报告模板：  \n            "),t.taskDetail.task_files?a("el-tag",{staticClass:"marr10 mart10"},[a("a",{attrs:{href:""+t.common.publicBasePath+JSON.parse(t.taskDetail.task_files).path,target:"_blank"}},[t._v("\n                "+t._s(JSON.parse(t.taskDetail.task_files).name)+"\n              ")])]):a("span",[t._v("无")])],1),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            报告类型："+t._s(2==t.taskDetail.genre?"个人报告":"小组报告")+" \n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:24}},[t._v("\n            报告要求："+t._s(t.taskDetail.description)+"\n          ")]),a("el-col",{staticClass:"marb5",attrs:{span:12}},[t._v("\n            截止时间："+t._s(t.common._convertDate(t.taskDetail.end_time,"yyyy年MM月dd日"))+"  \n          ")])],1):t._e()],1)],1)]),a("div",{staticClass:"text-right mar10"},[t.experimentDetail&&!t.experimentReportList.length?a("el-button",{directives:[{name:"show",rawName:"v-show",value:!!t.experimentDetail.participant&&t.experimentDetail.participant.id,expression:"experimentDetail.participant ? experimentDetail.participant.id : false"}],attrs:{disabled:!t.common.checkAuthority("ReportTaskDetail_SubmitReport",!0),type:"primary"},on:{click:function(e){t.addReportDialog=!0}}},[t._v("\n      "+t._s(t.common.checkAuthority("ReportTaskDetail_SubmitReport")?t.common.checkAuthority("ReportTaskDetail_SubmitReport").name:"")+"\n    ")]):t._e()],1),a("el-dialog",{attrs:{width:"500px",title:"报告",closeOnClickModal:!1,visible:t.addReportDialog},on:{"update:visible":function(e){t.addReportDialog=e}}},[t.taskDetail?a("div",[a("el-form",{ref:"addReportForm",attrs:{model:t.addReportForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"报告模板：",prop:"path",rules:[{required:!0,message:"请选择报告模板",trigger:"blur"}]}},[a("upload",{attrs:{buttonText:"上传"},on:{uploadSuccess:t.uploadReportSuccess}}),a("span",[t._v(t._s(t.addReportForm.path?JSON.parse(t.addReportForm.path).name:""))])],1),a("el-form-item",{attrs:{prop:"comment",label:"报告描述",rules:[{required:!0,message:"请填写报告描述",trigger:"blur"},{validator:function(e,a,r){t.common.wordNumberValid(e,a,r,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",min:1,max:t.addReportForm.path},model:{value:t.addReportForm.comment,callback:function(e){t.$set(t.addReportForm,"comment",e)},expression:"addReportForm.comment"}})],1)],1)],1):t._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.submitReport("addReportForm")}}},[t._v("提 交")]),a("el-button",{on:{click:function(e){t.addReportDialog=!1,t.$refs.addReportForm&&t.$refs.addReportForm.resetFields()}}},[t._v("取 消")])],1)]),a("el-dialog",{attrs:{width:"550px",title:"编辑报告",visible:t.reportTaskDialog},on:{"update:visible":function(e){t.reportTaskDialog=e}}},[a("el-form",{ref:"reportTaskForm",attrs:{model:t.reportTaskForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务名称：",prop:"name",rules:[{required:!0,message:"请输入任务名称",trigger:"blur"},{validator:function(e,a,r){t.common.wordNumberValid(e,a,r,"single")},trigger:"blur"}]}},[a("el-input",{model:{value:t.reportTaskForm.name,callback:function(e){t.$set(t.reportTaskForm,"name",e)},expression:"reportTaskForm.name"}})],1),a("el-form-item",{attrs:{label:"截止日期：",prop:"end_time",rules:[{required:!0,message:"请选择截止日期",trigger:"blur"}]}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.reportTaskForm.end_time,callback:function(e){t.$set(t.reportTaskForm,"end_time",e)},expression:"reportTaskForm.end_time"}})],1),a("el-form-item",{attrs:{label:"得分占比：",prop:"value",rules:[{required:!0,message:"请输入得分占比",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1,max:100},model:{value:t.reportTaskForm.value,callback:function(e){t.$set(t.reportTaskForm,"value",e)},expression:"reportTaskForm.value"}}),t._v(" %\n        ")],1),a("el-form-item",{attrs:{label:"总分：",prop:"score",rules:[{required:!0,message:"请输入总分",trigger:"blur"}]}},[a("el-input-number",{attrs:{type:"number",min:1},model:{value:t.reportTaskForm.score,callback:function(e){t.$set(t.reportTaskForm,"score",e)},expression:"reportTaskForm.score"}})],1),a("el-form-item",{attrs:{label:"报告类型：",prop:"genre",rules:[{required:!0,message:"请选择报告类型",trigger:"blur"}]}},[a("el-radio-group",{model:{value:t.reportTaskForm.genre,callback:function(e){t.$set(t.reportTaskForm,"genre",e)},expression:"reportTaskForm.genre"}},[a("el-radio",{attrs:{label:1}},[t._v("小组报告")]),a("el-radio",{attrs:{label:2}},[t._v("个人报告")])],1)],1),a("el-form-item",{attrs:{label:"报告要求：",prop:"description",rules:[{required:!0,message:"请输入报告要求",trigger:"blur"},{validator:function(e,a,r){t.common.wordNumberValid(e,a,r,"textarea")},trigger:"blur"}]}},[a("el-input",{attrs:{type:"textarea",rows:6},model:{value:t.reportTaskForm.description,callback:function(e){t.$set(t.reportTaskForm,"description",e)},expression:"reportTaskForm.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.reportTaskDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitEditReportTask("reportTaskForm")}}},[t._v("保存")])],1)],1),a("el-dialog",{attrs:{width:"500px",title:"打分",closeOnClickModal:!1,visible:t.scoreDialog},on:{"update:visible":function(e){t.scoreDialog=e}}},[t.taskDetail?a("div",[a("el-form",{ref:"scoreForm",attrs:{model:t.scoreForm,"label-width":"80px"}},[a("el-form-item",{attrs:{prop:"score",label:"得分",rules:[{required:!0,message:"请打分",trigger:"blur"}]}},[a("el-input-number",{attrs:{min:1,max:t.taskDetail.score},model:{value:t.scoreForm.score,callback:function(e){t.$set(t.scoreForm,"score",e)},expression:"scoreForm.score"}}),t._v("\n             "+t._s("最大分数："+t.taskDetail.score)+"分\n          ")],1)],1)],1):t._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.submitScore("scoreForm")}}},[t._v("打 分")]),a("el-button",{on:{click:function(e){t.scoreDialog=!1}}},[t._v("取 消")])],1)])],1)},s=[],o=a("d443"),i={components:{upload:o["a"]},data:function(){return{paperDialog:!1,scoreDialog:!1,addReportDialog:!1,reportTaskDialog:!1,taskDetail:null,courseDetail:null,experimentDetail:null,isLoad:!0,experimentReportList:[],questionActiveName:"1",answerMemberListData:[],loginUserId:sessionStorage.getItem("access_key"),isPaperDialogShowClose:!0,scoreForm:{score:null,id:null},addReportForm:{comment:null,path:null,participant_id:null,task_id:this.$route.params.id},selectScoreItemData:null,reportTaskForm:{experiment_id:this.$route.params.id,name:null,value:null,score:null,end_time:null,description:null,genre:null}}},computed:{reportStatus:function(){if(this.taskDetail)switch(this.taskDetail.cur_status){case 1:return"未发布";case 2:return"进行中";case 3:return"已截止";case 4:return"已结束"}}},mounted:function(){this.getQueryTaskDetail(),this.getQueryCourseDetail(),this.getQueryExperimentDetail(),this.getQueryExperimentReportList()},methods:{getQueryCourseDetail:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/course/detail/").concat(this.$route.params.id),"").then(function(e){t.courseDetail=e.data.data,t.isLoad=!1}).catch(function(e){t.$message.error(e),t.isLoad=!1})},getQueryTaskDetail:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/task/").concat(this.$route.params.id),"").then(function(e){t.taskDetail=e.data.data,t.isLoad=!1}).catch(function(e){t.$message.error(e),t.isLoad=!1})},getQueryExperimentDetail:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/experiment/").concat(this.$route.params.experiment_id),"").then(function(e){t.experimentDetail=e.data.data,t.isLoad=!1}).catch(function(e){t.$message.error(e),t.isLoad=!1})},getQueryExperimentReportList:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/report/list/").concat(this.$route.params.id),"").then(function(e){t.experimentReportList=e.data.data,t.isLoad=!1}).catch(function(e){t.$message.error(e),t.isLoad=!1})},showScoreDialog:function(t){this.$refs.scoreForm&&this.$refs.scoreForm.resetFields(),this.scoreDialog=!0,this.scoreForm.id=t.id,this.selectScoreItemData=t},submitScore:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e._submitScore()})},_submitScore:function(){var t=this;this.axios.patch("".concat(this.common.basePath,"/report/").concat(this.scoreForm.id),this.scoreForm).then(function(e){t.$message.success(e.data.meta.message),t.scoreDialog=!1,t.selectScoreItemData.score=t.scoreForm.score,t.getQueryExperimentReportList()}).catch(function(e){t.scoreDialog=!1,t.$message.error(e)})},submitReport:function(t){var e=this;this.addReportForm.participant_id=this.experimentDetail.participant.id,this.$refs[t].validate(function(t){if(!t)return!1;e._submitReport()})},_submitReport:function(){var t=this;this.axios.post("".concat(this.common.basePath,"/report"),this.addReportForm).then(function(e){t.addReportDialog=!1,t.getQueryExperimentReportList()}).catch(function(e){t.addReportDialog=!1,t.$message.error(e)})},submitEditReportTask:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.axios.patch("".concat(e.common.basePath,"/task/").concat(e.$route.params.id),e.reportTaskForm).then(function(t){e.getQueryTaskDetail(),e.reportTaskDialog=!1}).catch(function(t){e.$message.error(t),e.reportTaskDialog=!1})})},releaseTask:function(){var t=this;this.axios.get("".concat(this.common.basePath,"/task/release/").concat(this.$route.params.id),"").then(function(e){t.$message.success(e.data.meta.message),t.getQueryTaskDetail()}).catch(function(e){t.$message.error(e)})},uploadReportSuccess:function(t){this.addReportForm.path=JSON.stringify(t)}}},n=i,l=(a("4e03"),a("2877")),c=Object(l["a"])(n,r,s,!1,null,null,null);c.options.__file="ReportTaskDetail.vue";e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-61e2.ebfaf1bf.js.map