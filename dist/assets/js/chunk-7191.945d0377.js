(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7191"],{1033:function(e,t,a){},2244:function(e,t,a){"use strict";var n=a("1033"),s=a.n(n);s.a},"28a5":function(e,t,a){a("214f")("split",2,function(e,t,n){"use strict";var s=a("aae3"),i=n,r=[].push,o="split",c="length",l="lastIndex";if("c"=="abbc"[o](/(b)*/)[1]||4!="test"[o](/(?:)/,-1)[c]||2!="ab"[o](/(?:ab)*/)[c]||4!="."[o](/(.?)(.?)/)[c]||"."[o](/()()/)[c]>1||""[o](/.?/)[c]){var u=void 0===/()??/.exec("")[1];n=function(e,t){var a=String(this);if(void 0===e&&0===t)return[];if(!s(e))return i.call(a,e,t);var n,o,p,m,d,h=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),_=0,v=void 0===t?4294967295:t>>>0,w=new RegExp(e.source,f+"g");u||(n=new RegExp("^"+w.source+"$(?!\\s)",f));while(o=w.exec(a)){if(p=o.index+o[0][c],p>_&&(h.push(a.slice(_,o.index)),!u&&o[c]>1&&o[0].replace(n,function(){for(d=1;d<arguments[c]-2;d++)void 0===arguments[d]&&(o[d]=void 0)}),o[c]>1&&o.index<a[c]&&r.apply(h,o.slice(1)),m=o[0][c],_=p,h[c]>=v))break;w[l]===o.index&&w[l]++}return _===a[c]?!m&&w.test("")||h.push(""):h.push(a.slice(_)),h[c]>v?h.slice(0,v):h}}else"0"[o](void 0,0)[c]&&(n=function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)});return[function(a,s){var i=e(this),r=void 0==a?void 0:a[t];return void 0!==r?r.call(a,i,s):n.call(String(i),a,s)},n]})},"3e72":function(e,t,a){},"997b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"contentWrap",staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("问卷调查")])],1)],1),a("div",{ref:"contentWrap",staticClass:"router-view-wrap"},[a("div",{staticClass:"router-view-content"},[a("el-form",{ref:"searchForm",attrs:{model:e.searchForm,inline:!0,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"实验课程：",prop:"course_id"}},[a("el-select",{on:{change:e.courseChange},model:{value:e.searchForm.course_id,callback:function(t){e.$set(e.searchForm,"course_id",t)},expression:"searchForm.course_id"}},e._l(e.courseListData.rows,function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.name}})}))],1),a("el-form-item",{attrs:{label:"实验名称：",prop:"experiment_id"}},[a("el-select",{model:{value:e.searchForm.experiment_id,callback:function(t){e.$set(e.searchForm,"experiment_id",t)},expression:"searchForm.experiment_id"}},e._l(e.experimentListData.rows,function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.name}})}))],1),a("el-form-item",{attrs:{label:"问卷类型：",prop:"questionnaireType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.searchForm.questionnaireType,callback:function(t){e.$set(e.searchForm,"questionnaireType",t)},expression:"searchForm.questionnaireType"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),a("el-form-item",[a("el-button",{attrs:{disabled:!e.common.checkAuthority("ExperimentalQuestionnaire_QueryList",!0),type:"primary"},on:{click:function(t){e.getQueryList()}}},[e._v("\n            "+e._s(e.common.checkAuthority("ExperimentalQuestionnaire_QueryList")?e.common.checkAuthority("ExperimentalQuestionnaire_QueryList").name:"")+"\n          ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.resetSearchForm}},[e._v("置空")])],1)],1),a("el-table",{attrs:{data:e.listData.rows,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"实验名称",prop:"experimentName","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.experimentName))])]}}])}),a("el-table-column",{attrs:{label:"课程名称",prop:"courseName","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.courseName))])]}}])}),a("el-table-column",{attrs:{label:"任务名称",prop:"name","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:"问卷名称",prop:"questionnaireName","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.questionnaireName))])]}}])}),a("el-table-column",{attrs:{width:"150px",prop:"questionnaireType",label:"问卷类型","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.questionnaireType(t.row.questionnaireType))+"\n          ")]}}])}),a("el-table-column",{attrs:{width:"150px",prop:"end_time",label:"截止时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.common._convertDate(t.row.end_time,"yyyy年MM月dd日"))+"\n          ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"80px","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{disabled:!e.common.checkAuthority("ExperimentalQuestionnaire_Write",!0),type:"primary",size:"mini"},on:{click:function(a){e.showPaper(t.row)}}},[e._v("\n                "+e._s(e.common.checkAuthority("ExperimentalQuestionnaire_Write")?e.common.checkAuthority("ExperimentalQuestionnaire_Write").name:"")+"\n              ")])],1)]}}])})],1),a("div",{staticClass:"router-view-bottom mart10"},[a("div"),a("el-pagination",{staticClass:"fr ",attrs:{disabled:!e.common.checkAuthority("ExperimentalQuestionnaire_QueryList",!0),background:"","current-page":e.common.elementPagination.pageNum,"page-sizes":e.common.elementPagination.pageSizes,"page-size":e.common.elementPagination.pageSizeDefault,layout:"total, sizes, prev, pager, next",total:e.listData.total},on:{"size-change":function(t){e.handleSizeChange(t)},"current-change":function(t){e.handleCurrentChange(t)}}})],1)],1)]),a("el-dialog",{attrs:{width:"70vw",title:"问卷调查填写表",closeOnClickModal:!1,showClose:e.isPaperDialogShowClose,visible:e.paperDialog},on:{"update:visible":function(t){e.paperDialog=t}}},[e.activeAnswerItem?a("experimental-qestionnaire-write",{attrs:{questionnaireData:e.activeAnswerItem},on:{isPaperDialogShowClose:e.isPaperDialogShowCloseFun,closePaperDialog:e.closePaperDialogFun}}):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.paperDialog=!1}}},[e._v("取 消")])],1)],1)],1)},s=[],i=(a("cadf"),a("551c"),a("097d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.paperItem?a("div",[a("div",[a("el-radio-group",{model:{value:e.participantId,callback:function(t){e.participantId=t},expression:"participantId"}},e._l(e.answerMemberListData,function(t,n){return a("el-radio-button",{attrs:{label:t.id}},[e._v(e._s(t.user_name))])}))],1),a("hr"),a("el-form",{ref:"paperItem",attrs:{model:e.paperItem,"label-width":"120px"}},[a("el-row",{staticClass:"mard10"},[a("el-col",{staticClass:"mard10",attrs:{span:12}},[a("span",[e._v(e._s(e.paperItem.name))])]),a("el-col",{staticClass:"mard10",attrs:{span:12}},[a("span",[e._v(e._s(e.questionaireType(e.paperItem.type)))])]),a("el-col",{staticClass:"mart10",attrs:{span:24}},[a("span",[e._v(e._s(e.paperItem.description))])])],1)],1),a("el-card",{attrs:{shadow:"never"}},[e._l(e.qItems,function(t,n){return a("div",{key:n,staticClass:"questions-box mart5"},[a("div",[e._v(e._s(n+1)+"、")]),a("el-card",{staticClass:"questions-content",attrs:{shadow:"never"}},[a("el-row",{staticClass:"mard10"},[a("el-col",{staticClass:"div-flex",attrs:{span:17}},[a("div",{staticClass:"label-2 label marr5"},[e._v("题干: ")]),a("div",[1==t.type?a("span",[e._v(e._s(t.question))]):e._e(),2==t.type?a("span",[e._v(e._s(t.question)+" （最多能选择"+e._s(t.max_option)+"项）")]):e._e(),4==t.type?a("span",[e._v(e._s(t.question)+"（最大分数："+e._s(t.score)+"分）")]):e._e()])]),a("el-col",{staticClass:"text-right question-type",attrs:{offset:1,span:5}},[e._v("\n            "+e._s(e.numMatchingText(t.type))+"\n          ")])],1),a("el-row",{staticClass:"mard10"},[a("el-col",{attrs:{span:22}},[a("div",{staticStyle:{"margin-left":"60px"}},[1==t.type?a("el-radio-group",{model:{value:t.answer,callback:function(a){e.$set(t,"answer",a)},expression:"item.answer"}},e._l(t.options,function(t,n){return a("div",{key:n,staticClass:"div-flex mart10 flex-align-items"},[a("el-radio",{staticClass:"marl5",attrs:{disabled:!!e.sheet_id,label:t.id}},[e._v("\n                    选项"+e._s(n+1)+"：（"+e._s(t.score)+"分）"+e._s(t.answer)+"\n                  ")])],1)})):e._e(),2==t.type?a("el-checkbox-group",{attrs:{max:t.max_option},model:{value:t.answer,callback:function(a){e.$set(t,"answer",a)},expression:"item.answer"}},e._l(t.options,function(t,n){return a("div",{key:n,staticClass:"div-flex mart10 flex-align-items"},[a("el-checkbox",{staticClass:"marl5",attrs:{disabled:!!e.sheet_id,label:t.id}},[e._v(" \n                    选项"+e._s(n+1)+"：（"+e._s(t.score)+"分）"+e._s(t.answer)+"\n                  ")])],1)})):e._e(),4==t.type?a("div",[a("el-input",{attrs:{disabled:!!e.sheet_id,type:"textarea",rows:"5"},model:{value:t.answer,callback:function(a){e.$set(t,"answer",a)},expression:"item.answer"}}),a("div",{staticClass:"div-flex mart10"},[e._v("\n                  *得分："),a("el-input-number",{attrs:{disabled:!!e.sheet_id,max:t.score},model:{value:t.scoreA,callback:function(a){e.$set(t,"scoreA",a)},expression:"item.scoreA"}}),e._v(" 分\n                ")],1)],1):e._e()],1)])],1)],1)],1)}),a("div",{staticClass:"text-right mart10"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.sheet_id,expression:"!sheet_id"}],attrs:{type:"primary"},on:{click:function(t){e.submit()}}},[e._v("提交")])],1)],2)],1):e._e()}),r=[],o=(a("c5f6"),a("28a5"),a("ac6a"),{props:["questionnaireData"],data:function(){return{questionTypeText:null,paperItem:null,qItems:[],answerMemberListData:[],participantId:"default",sheet_id:null}},components:{},computed:{},watch:{questionnaireData:function(e,t){e&&(this.getQueryAnswerMember(),this.getQueryPaperDetail())},participantId:function(e,t){"default"!=t&&(this._isHasSheetId(),this.getQueryQuestionnaireList())}},mounted:function(){this.getQueryAnswerMember(),this.getQueryPaperDetail()},methods:{getQueryAnswerMember:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/qanswer/member/").concat(this.questionnaireData.id),"").then(function(t){e.answerMemberListData=t.data.data,"default"==e.participantId&&(e.participantId=t.data.data?t.data.data[0].id:""),e._isHasSheetId(),e.getQueryQuestionnaireList()}).catch(function(t){e.$message.error(t)})},questionaireType:function(e){switch(e){case 1:return"评价教学";case 2:return"互评";case 3:return"自评"}},numMatchingText:function(e){switch(e){case 1:return this.questionTypeText="单选题";case 2:return this.questionTypeText="多选题";case 3:return this.questionTypeText="判断题";case 4:return this.questionTypeText="评语"}},getQueryPaperDetail:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/questionnaire/").concat(this.questionnaireData.questionnaireId),"").then(function(t){e.paperItem=t.data.data}).catch(function(t){e.$message.error(t)})},getQueryQuestionnaireList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/qitem"),{params:{questionnaire_id:this.questionnaireData.questionnaireId,sheet_id:this.sheet_id}}).then(function(t){e.qItems=e._convertQItems(t.data.data.rows)}).catch(function(t){e.$message.error(t)})},_convertQItems:function(e){return e.forEach(function(e){1==e.type?e.answer=e.answer?parseInt(e.answer.answer):null:2==e.type?e.answer=e.answer?e.answer.answer.split(",").map(Number):[]:4==e.type&&(e.scoreA=e.answer?e.answer.score:null,e.answer=e.answer?e.answer.answer:null)}),e},submit:function(){var e=this;this.axios.post("".concat(this.common.basePath,"/qanswer/answer/").concat(this.questionnaireData.questionnaireId,"/").concat(this.participantId,"/").concat(this.questionnaireData.id),this._convertAnswer()).then(function(t){e.getQueryAnswerMember(),e.$message.success(t.data.meta.message),e.$emit("closePaperDialog")}).catch(function(t){e.$message.error(t)})},_convertAnswer:function(){var e=[];return this.qItems.forEach(function(t){2==t.type?e.push({item_id:t.id,answer:t.answer.join(",")}):4==t.type?e.push({item_id:t.id,answer:t.answer,score:t.scoreA}):e.push({item_id:t.id,answer:t.answer})}),e},_isHasSheetId:function(){var e=this;this.answerMemberListData&&this.answerMemberListData.forEach(function(t){t.id==e.participantId&&(e.sheet_id=t.sheet_id)})}}}),c=o,l=(a("2244"),a("2877")),u=Object(l["a"])(c,i,r,!1,null,null,null);u.options.__file="ExperimentalQuestionnaireWrite.vue";var p=u.exports,m={data:function(){return{paperDialog:!1,isPaperDialogShowClose:!0,searchForm:{experiment_id:null,questionnaireType:null,pageNum:this.common.elementPagination.pageNumDefault,pageSize:this.common.elementPagination.pageSizeDefault},statusOptions:[{label:"评价教学",value:1},{label:"小组互评",value:2},{label:"自评",value:3}],listData:{total:0,rows:[]},courseListData:{total:0,rows:[]},experimentListData:{total:0,rows:[]},activeAnswerItem:null}},watch:{},created:function(){},components:{"experimental-qestionnaire-write":p},mounted:function(){this.getQueryList(),this.getQueryCourseList()},methods:{questionnaireType:function(e){if(e)switch(e){case 1:return"评价教学";case 2:return"小组互评";case 3:return"自评"}},resetSearchForm:function(){this.$refs.searchForm&&this.$refs.searchForm.resetFields()},handleCurrentChange:function(e){this.searchForm.pageNum=e,this.getQueryList()},handleSizeChange:function(e){this.searchForm.pageSize=e,this.getQueryList()},getQueryList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/questionnaire/student/task"),{params:this.searchForm}).then(function(t){e.listData=t.data.data}).catch(function(t){e.$message.error(t)})},getQueryCourseList:function(){var e=this;this.axios.get("".concat(this.common.basePath,"/course"),"").then(function(t){e.courseListData=t.data.data}).catch(function(t){e.$message.error(t)})},getQueryExperimentList:function(e){var t=this;this.axios.get("".concat(this.common.basePath,"/experiment"),{params:{course_id:e}}).then(function(e){t.experimentListData=e.data.data}).catch(function(e){t.$message.error(e)})},courseChange:function(e){this.searchForm.experiment_id=null,this.getQueryExperimentList(e)},closePaperDialogFun:function(){this.paperDialog=!1,this.getQueryList()},isPaperDialogShowCloseFun:function(e){console.log(e),this.isPaperDialogShowClose=e,this.getQueryList()},showPaper:function(e){this.activeAnswerItem=e,this.paperDialog=!0},goToDetail:function(e){this.$message("查看详情，待开发")}}},d=m,h=(a("f958"),Object(l["a"])(d,n,s,!1,null,null,null));h.options.__file="ExperimentalQuestionnaire.vue";t["default"]=h.exports},aa77:function(e,t,a){var n=a("5ca1"),s=a("be13"),i=a("79e5"),r=a("fdef"),o="["+r+"]",c="​",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),p=function(e,t,a){var s={},o=i(function(){return!!r[e]()||c[e]()!=c}),l=s[e]=o?t(m):r[e];a&&(s[a]=l),n(n.P+n.F*o,"String",s)},m=p.trim=function(e,t){return e=String(s(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=p},c5f6:function(e,t,a){"use strict";var n=a("7726"),s=a("69a8"),i=a("2d95"),r=a("5dbc"),o=a("6a99"),c=a("79e5"),l=a("9093").f,u=a("11e9").f,p=a("86cc").f,m=a("aa77").trim,d="Number",h=n[d],f=h,_=h.prototype,v=i(a("2aeb")(_))==d,w="trim"in String.prototype,g=function(e){var t=o(e,!1);if("string"==typeof t&&t.length>2){t=w?t.trim():m(t,3);var a,n,s,i=t.charCodeAt(0);if(43===i||45===i){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===i){switch(t.charCodeAt(1)){case 66:case 98:n=2,s=49;break;case 79:case 111:n=8,s=55;break;default:return+t}for(var r,c=t.slice(2),l=0,u=c.length;l<u;l++)if(r=c.charCodeAt(l),r<48||r>s)return NaN;return parseInt(c,n)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof h&&(v?c(function(){_.valueOf.call(a)}):i(a)!=d)?r(new f(g(t)),a,h):g(t)};for(var b,y=a("9e1e")?l(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;y.length>x;x++)s(f,b=y[x])&&!s(h,b)&&p(h,b,u(f,b));h.prototype=_,_.constructor=h,a("2aba")(n,d,h)}},f958:function(e,t,a){"use strict";var n=a("3e72"),s=a.n(n);s.a},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-7191.945d0377.js.map