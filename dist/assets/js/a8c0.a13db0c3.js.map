{"version":3,"sources":["webpack:///./src/views/settings/SchoolYear.vue?c485","webpack:///src/views/settings/SchoolYear.vue","webpack:///./src/views/settings/SchoolYear.vue?1a04","webpack:///./src/views/settings/SchoolYear.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","separator-class","_v","directives","name","rawName","value","expression","common","checkAuthority","span","type","size","disabled","filterText","on","click","$event","showDialog","data","treeData","props","defaultProps","scopedSlots","_u","key","fn","ref","node","mouseenter","mouseleave","tempId","type_id","_e","_s","label","staticStyle","color","font-size","_convertDate","start_time","end_time","id","stopPropagation","deleteTree","title","editOrAdd","visible","dialogVisible","width","update:visible","model","schoolYearForm","label-width","typeId","prop","rules","required","message","trigger","placeholder","callback","$$v","$set","picker-options","startDatePicker","range-separator","start-placeholder","end-placeholder","slot","submitForm","staticRenderFns","SchoolYearvue_type_script_lang_js_","_this","disabledDate","time","tempYearName","getTime","Date","concat","isLoading","children","tempData","parent_id","dateTime","watch","mounted","initTree","methods","_this2","config","method","url","basePath","axios","then","response","catch","errorMsg","$message","error","operationType","formName","_this3","$refs","validate","valid","_updateSubmit","_addSubmit","_this4","post","submitParams","success","meta","_this5","patch","parentId","_this6","authorityForm","JSON","parse","stringify","$confirm","confirmButt才去onText","cancelButtonText","_","settings_SchoolYearvue_type_script_lang_js_","component","Object","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"assets/js/a8c0.a13db0c3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content-wrap-box\"},[_c('el-card',{staticClass:\"title-card\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',[_vm._v(\"学年学期\")])],1)],1),_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.isLoading),expression:\"isLoading\"}],staticClass:\"router-view-wrap\"},[_c('div',{staticClass:\"router-view-content\"},[(_vm.common.checkAuthority('SchoolYear-tree', true))?_c('el-row',{staticClass:\"padding-row\"},[_c('el-col',{attrs:{\"span\":24}}),_c('el-col',{attrs:{\"span\":24}},[_c('div',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\",\"disabled\":!!_vm.filterText || !_vm.common.checkAuthority('SchoolYeardd_AddYear', true)},on:{\"click\":function($event){_vm.showDialog(null, 'addYear')}}},[_vm._v(\"添加学年\")])],1),_c('el-tree',{attrs:{\"data\":_vm.treeData,\"props\":_vm.defaultProps},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nvar data = ref.data;\nreturn _c('span',{staticClass:\"fill-width\"},[_c('div',{on:{\"mouseenter\":function($event){_vm.mouseenter(data)},\"mouseleave\":function($event){_vm.tempId = null}}},[_c('span',[(data.type_id == 1)?_c('i',{staticClass:\"fa fa-desktop text-primary\"}):_vm._e(),(data.type_id == 2)?_c('i',{staticClass:\"fa fa-mouse-pointer text-info\"}):_vm._e(),_vm._v(\"\\n                  \"+_vm._s(node.label)+\" \\n                  \"),_c('span',{staticClass:\"marl10\",staticStyle:{\"color\":\"#ccc\",\"font-size\":\"14px\"}},[_vm._v(_vm._s(data.type_id == 2 ? (\"（时段：\" + (_vm.common._convertDate(data.start_time, 'yyyy-MM-dd')) + \" ~ \" + (_vm.common._convertDate(data.end_time, 'yyyy-MM-dd')) + \"）\") : ''))]),_vm._v(\"    \\n                  \"),(_vm.tempId == data.id)?_c('span',[(data.type_id == 1 && _vm.common.checkAuthority('SchoolYear_AddSchool', true))?_c('el-button',{attrs:{\"type\":\"text\",\"disabled\":!_vm.common.checkAuthority('SchoolYear_AddSchool', true)},on:{\"click\":function($event){$event.stopPropagation();_vm.showDialog(data, 'addSchool')}}},[_vm._v(\"添加学期\")]):_vm._e(),(_vm.common.checkAuthority('SchoolYear_Edit', true))?_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){$event.stopPropagation();_vm.showDialog(data, 'edit')}}},[_vm._v(\"编辑\")]):_vm._e(),(_vm.common.checkAuthority('SchoolYear_delete', true))?_c('el-button',{staticClass:\"text-danger\",attrs:{\"type\":\"text\"},on:{\"click\":function($event){$event.stopPropagation();_vm.deleteTree(data)}}},[_vm._v(\"删除\")]):_vm._e()],1):_vm._e()])])])}}])})],1)],1):_vm._e()],1)]),_c('el-dialog',{attrs:{\"title\":(\"\" + (_vm.editOrAdd == 'edit' ? '编辑' : '添加') + (_vm.editOrAdd == 'addYear' ? '学年' : '学期')),\"visible\":_vm.dialogVisible,\"width\":\"50vw\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"schoolYearForm\",attrs:{\"model\":_vm.schoolYearForm,\"label-width\":\"100px\"}},[(_vm.editOrAdd == 'addYear' || (_vm.editOrAdd == 'edit' && _vm.typeId == 1))?_c('el-form-item',{attrs:{\"label\":\"学年\",\"prop\":\"name\",\"rules\":[\n          { required: true, message: '请输入学年', trigger: 'blur' } ]}},[_c('el-date-picker',{attrs:{\"type\":\"year\",\"placeholder\":\"选择年\"},model:{value:(_vm.schoolYearForm.name),callback:function ($$v) {_vm.$set(_vm.schoolYearForm, \"name\", $$v)},expression:\"schoolYearForm.name\"}})],1):_vm._e(),(_vm.editOrAdd == 'addSchool' || (_vm.editOrAdd == 'edit' && _vm.typeId == 2))?_c('el-form-item',{attrs:{\"label\":\"学期名称\",\"prop\":\"name\"}},[_c('el-input',{model:{value:(_vm.schoolYearForm.name),callback:function ($$v) {_vm.$set(_vm.schoolYearForm, \"name\", $$v)},expression:\"schoolYearForm.name\"}})],1):_vm._e(),(_vm.editOrAdd == 'addSchool' || (_vm.editOrAdd == 'edit' && _vm.typeId == 2))?_c('el-form-item',{attrs:{\"label\":\"开始结束时间\",\"prop\":\"dateTime\"}},[_c('el-date-picker',{attrs:{\"picker-options\":_vm.startDatePicker,\"type\":\"daterange\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\"},model:{value:(_vm.schoolYearForm.dateTime),callback:function ($$v) {_vm.$set(_vm.schoolYearForm, \"dateTime\", $$v)},expression:\"schoolYearForm.dateTime\"}})],1):_vm._e()],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.submitForm('schoolYearForm')}}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"content-wrap-box\">\r\n    <el-card class=\"title-card\">\r\n      <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n        <el-breadcrumb-item>学年学期</el-breadcrumb-item> \r\n      </el-breadcrumb>\r\n    </el-card>\r\n    <div class=\"router-view-wrap\" v-loading=\"isLoading\">\r\n      <!-- 页面主要内容 -->\r\n      <div class=\"router-view-content\">\r\n        <el-row class=\"padding-row\" v-if=\"common.checkAuthority('SchoolYear-tree', true)\">\r\n          <el-col :span=\"24\">\r\n            <!-- <el-input placeholder=\"输入关键字进行过滤\" v-model=\"filterText\" clearable></el-input> -->\r\n          </el-col>\r\n          <el-col :span=\"24\">\r\n            <div><el-button type=\"primary\" size=\"mini\" @click=\"showDialog(null, 'addYear')\" :disabled=\"!!filterText || !common.checkAuthority('SchoolYeardd_AddYear', true)\">添加学年</el-button></div>\r\n            <el-tree :data=\"treeData\" :props=\"defaultProps\">\r\n              <span class=\"fill-width\" slot-scope=\"{ node, data }\">\r\n                <div @mouseenter=\" mouseenter(data) \" @mouseleave=\"tempId = null\">\r\n                  <span>\r\n                    <i class=\"fa fa-desktop text-primary\" v-if=\"data.type_id == 1\"></i>\r\n                    <i class=\"fa fa-mouse-pointer text-info\" v-if=\"data.type_id == 2\"></i>\r\n                    {{ node.label }} \r\n                    <span class=\"marl10\" style=\"color: #ccc; font-size: 14px; \">{{ data.type_id == 2 ? `（时段：${common._convertDate(data.start_time, 'yyyy-MM-dd')} ~ ${common._convertDate(data.end_time, 'yyyy-MM-dd')}）` : '' }}</span>&nbsp;&nbsp;  \r\n                    <span v-if=\"tempId == data.id\"> \r\n                      <el-button @click.stop=\"showDialog(data, 'addSchool')\" v-if=\"data.type_id == 1 && common.checkAuthority('SchoolYear_AddSchool', true)\" type=\"text\"  :disabled=\"!common.checkAuthority('SchoolYear_AddSchool', true)\">添加学期</el-button>\r\n                      <el-button type=\"text\" @click.stop=\"showDialog(data, 'edit')\" v-if=\"common.checkAuthority('SchoolYear_Edit', true)\">编辑</el-button>\r\n                      <el-button type=\"text\" v-if=\"common.checkAuthority('SchoolYear_delete', true)\" class=\"text-danger\"  @click.stop=\"deleteTree(data)\">删除</el-button>\r\n                    </span>\r\n                  </span>\r\n                </div>\r\n              </span>\r\n            </el-tree>\r\n          </el-col>\r\n        </el-row>\r\n      </div> \r\n    </div>   \r\n    <el-dialog \r\n      :title=\"`${editOrAdd == 'edit' ? '编辑' : '添加'}${editOrAdd == 'addYear' ? '学年' : '学期' }`\" \r\n      :visible.sync=\"dialogVisible\" width=\"50vw\">\r\n      <el-form ref=\"schoolYearForm\"  :model=\"schoolYearForm\" label-width=\"100px\">\r\n        <el-form-item \r\n          v-if=\"editOrAdd == 'addYear' || (editOrAdd == 'edit' && typeId == 1)\"\r\n          label=\"学年\" \r\n          prop=\"name\"\r\n          :rules=\"[\r\n            { required: true, message: '请输入学年', trigger: 'blur' }, \r\n          ]\">\r\n          <el-date-picker\r\n            v-model=\"schoolYearForm.name\"\r\n            type=\"year\"\r\n            placeholder=\"选择年\">\r\n          </el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item v-if=\"editOrAdd == 'addSchool' || (editOrAdd == 'edit' && typeId == 2)\" label=\"学期名称\" prop=\"name\"><el-input v-model=\"schoolYearForm.name\"></el-input></el-form-item>\r\n        <el-form-item v-if=\"editOrAdd == 'addSchool' || (editOrAdd == 'edit' && typeId == 2)\" label=\"开始结束时间\" prop=\"dateTime\">\r\n          <el-date-picker\r\n            :picker-options=\"startDatePicker\"\r\n            v-model=\"schoolYearForm.dateTime\"\r\n            type=\"daterange\"\r\n            range-separator=\"至\"\r\n            start-placeholder=\"开始日期\"\r\n            end-placeholder=\"结束日期\" >\r\n          </el-date-picker>\r\n        </el-form-item> \r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitForm('schoolYearForm')\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        startDatePicker: {\r\n          disabledDate: (time) => { \r\n            if(this.tempYearName){\r\n              // var date = new Date(this.tempYearName);\r\n              // var year = date.getFullYear();\r\n              // var month = date.getMonth() + 1;\r\n              // if (month >= 1 && month <= 9) {\r\n              //     month = \"0\" + month;\r\n              // }\r\n              // var mindate = year.toString()  + month.toString();\r\n\r\n              // var timeyear = time.getFullYear();\r\n              // var timemonth = time.getMonth() + 1;\r\n              // if (timemonth >= 1 && timemonth <= 9) {\r\n              //     timemonth = \"0\" + timemonth;\r\n              // }\r\n              // var timedate = timeyear.toString() + timemonth.toString();\r\n              // return mindate > timedate;\r\n              return time.getTime() < new Date(`${this.tempYearName}-01-01`).getTime();\r\n            }else{\r\n              return true;\r\n            } \r\n          }\r\n        },\r\n        isLoading:      false,\r\n        dialogVisible:  false,\r\n        treeData:       null,\r\n        defaultProps: {\r\n          children: 'childrens',\r\n          label:    'name'\r\n        },\r\n        tempData:    null,// 当前浮动到那个元素上面\r\n        tempId:      null, //当前浮动到那个元素上面\r\n        typeId:      1, //1为学年，2为学期\r\n        editOrAdd: 'add', //add为添加，edit为编辑\r\n        tempYearName: null, //最后一次被选中的学年\r\n        filterText: null, //关键词检索\r\n        schoolYearForm: {\r\n          name:         null, \r\n          parent_id:    null,\r\n          start_time:   null,\r\n          end_time:     null, \r\n          type_id:      this.typeId,\r\n          dateTime:     [], //辅助用一下\r\n        }, \r\n      };\r\n    },\r\n    watch: { \r\n    },\r\n    mounted () {\r\n      this.initTree()\r\n    },\r\n    methods: { \r\n      /**\r\n       * 鼠标浮动获取当前树中的某一个对象\r\n       * @param  {[type]} data [description]\r\n       * @return {[type]}      [description]\r\n       */\r\n      mouseenter(data){\r\n        this.tempId = data.id; \r\n        data.type_id == 1 ? this.tempYearName = data.name : ''\r\n      },\r\n      /**\r\n       * 获取学年学期树\r\n       * @return {[type]} [description]\r\n       */\r\n      initTree() {\r\n        this.isLoading = true\r\n        let config = {\r\n          method: \"post\",\r\n          url: `${this.common.basePath}/configSemester/tree`,\r\n          data: {}\r\n        }\r\n        this.axios(config).then((response) => {\r\n          this.treeData   = response.data.data \r\n          this.isLoading = false;\r\n        }).catch((errorMsg) => {\r\n          this.isLoading = false\r\n          this.$message.error(errorMsg)\r\n        })\r\n      }, \r\n      showDialog(data, operationType){\r\n        this.tempData = data;\r\n        this.editOrAdd = operationType;\r\n        this.typeId = data ? data.type_id : this.typeId = 1; \r\n        this.schoolYearForm.parent_id = data ? data.parent_id : null;\r\n        this.schoolYearForm.name = data ? data.name : null;\r\n        //--------------- 编辑学期时 ------------\r\n        if(operationType == 'edit' && this.typeId == 2){\r\n          this.schoolYearForm.dateTime = [new Date(data.start_time), new Date(data.end_time)]; \r\n        }\r\n        // ------ 起到一个定位的作用 --------\r\n        if(operationType == 'addSchool'){\r\n          this.schoolYearForm.name = null;\r\n          this.schoolYearForm.dateTime = [new Date(`${this.tempYearName}-01-01`), new Date(`${this.tempYearName}-01-02`)] \r\n        }\r\n\r\n        if(operationType == 'addYear') {\r\n          this.schoolYearForm.name = null;\r\n        }\r\n        this.dialogVisible = true;\r\n      },\r\n      /**\r\n       * 提交表单\r\n       * @param  {[type]} formName [description]\r\n       * @return {[type]}          [description]\r\n       */      \r\n      submitForm(formName){\r\n        this.$refs[formName].validate(valid => {\r\n          if(valid) {   \r\n            if(this.editOrAdd == 'edit'){\r\n              this._updateSubmit();\r\n            }else{\r\n              this._addSubmit();\r\n            }\r\n          } else {\r\n            this.$message.error(\"请输入必填项\")\r\n          }\r\n        })\r\n      },\r\n      _addSubmit(){\r\n        this.axios.post(`${this.common.basePath}/configSemester`, this.submitParams()).then((response) => {\r\n            this.initTree();\r\n            this.$message.success(response.data.meta.message);\r\n            this.dialogVisible = false;\r\n        }).catch((error) => {\r\n          this.dialogVisible = false;\r\n          this.$message.error(error); \r\n        }); \r\n      },\r\n      _updateSubmit(){\r\n        this.axios.patch(`${this.common.basePath}/configSemester/${this.tempData.id}`, this.submitParams()).then((response) => {\r\n            this.initTree();\r\n            this.$message.success(response.data.meta.message);\r\n            this.dialogVisible = false;\r\n        }).catch((error) => {\r\n          this.dialogVisible = false;\r\n          this.$message.error(error); \r\n        }); \r\n      },\r\n      submitParams(){\r\n        if(this.editOrAdd == 'addYear' || (this.editOrAdd == 'edit' && this.typeId == 1)){ \r\n          return {\r\n            name:         this.common._convertDate(this.schoolYearForm.name, 'yyyy'), \r\n            type_id:      1, \r\n          }\r\n        }else if(this.editOrAdd == 'addSchool' || (this.editOrAdd == 'edit' && this.typeId == 2)){ \r\n          let parentId = this.editOrAdd == 'addSchool' ?  this.tempData.id : this.tempData.parent_id;\r\n          return {\r\n            name:         this.schoolYearForm.name, \r\n            parent_id:    parentId,\r\n            start_time:   this.schoolYearForm.dateTime[0].getTime(),\r\n            end_time:     this.schoolYearForm.dateTime[1].getTime(),\r\n            type_id:      2, \r\n          } \r\n        }  \r\n      },\r\n      /**\r\n       * 删除\r\n       * @param {[type]} parentId [description]\r\n       */\r\n      deleteTree(data) {\r\n        this.authorityForm = JSON.parse(JSON.stringify(data))\r\n\r\n        this.$confirm(\"删除后需要重新添加\", \"确认删除?\", {\r\n          confirmButt才去onText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n          type: \"warning\"\r\n        }).then(_ => { \r\n          let config = {\r\n            method: \"patch\",\r\n            url: `${this.common.basePath}/configSemester/delete/${data.id}`,\r\n          }\r\n          this.axios(config).then((response) => { \r\n            this.$message.success(response.data.meta.message) \r\n            this.initTree()\r\n          }).catch((errorMsg) => { \r\n            this.$message.error(errorMsg)\r\n          })\r\n        }).catch(_ => {})\r\n      },\r\n    }\r\n  };\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SchoolYear.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SchoolYear.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SchoolYear.vue?vue&type=template&id=2c681411&\"\nimport script from \"./SchoolYear.vue?vue&type=script&lang=js&\"\nexport * from \"./SchoolYear.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"SchoolYear.vue\"\nexport default component.exports"],"sourceRoot":""}