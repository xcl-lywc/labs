(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c37"],{"6beb":function(e,t,a){"use strict";var r=a("cb26"),s=a.n(r);s.a},7812:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrap-box"},[a("el-card",{staticClass:"title-card"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("设备维修")])],1)],1),a("div",{staticClass:"router-view-wrap"},[a("div",{staticClass:"router-view-content"},[e.common.checkAuthority("Repair-list",!0)?a("div",[a("el-form",{ref:"searchForm",attrs:{model:e.searchForm,"label-width":"120px"}},[a("el-row",[e.common.checkAuthorityTree("Standard-list")&&e.typeTree?a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"设备规格：",prop:"types"}},[a("el-cascader",{staticClass:"fill-width",attrs:{options:e.typeTree,props:e.typeTreeProps,"change-on-select":""},on:{change:e.cascaderChanged},model:{value:e.searchForm.types,callback:function(t){e.$set(e.searchForm,"types",t)},expression:"searchForm.types"}})],1)],1):e._e(),e.common.checkAuthorityTree("Standard-listType")?a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"设备型号：",prop:"model_id"}},[a("el-select",{staticClass:"fill-width",attrs:{placeholder:"请先选择规格后再选择型号",disabled:e.searchForm.types.length<=0},model:{value:e.searchForm.model_id,callback:function(t){e.$set(e.searchForm,"model_id",t)},expression:"searchForm.model_id"}},e._l(e.modelList,function(e,t){return a("el-option",{key:t+"型号",attrs:{value:e.id,label:e.model_name}})}))],1)],1):e._e(),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"编号：",prop:"code"}},[a("el-input",{staticClass:"fill-width",model:{value:e.searchForm.code,callback:function(t){e.$set(e.searchForm,"code",t)},expression:"searchForm.code"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"维修状态：",prop:"cur_status"}},[a("el-select",{staticClass:"fill-width",model:{value:e.searchForm.cur_status,callback:function(t){e.$set(e.searchForm,"cur_status",t)},expression:"searchForm.cur_status"}},e._l(e.common.repairStatus,function(e,t){return a("el-option",{key:"维修状态"+t,attrs:{value:e.id,label:e.label}})}))],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getTableList("init")}}},[e._v("搜索")]),a("el-button",{attrs:{type:"default"},on:{click:e.clearForm}},[e._v("重置")])],1)],1)],1)],1),a("el-table",{attrs:{data:e.tableData.rows}},[a("el-table-column",{attrs:{label:"编号",prop:"code",width:"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"序列号",prop:"serial_num",width:"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"规格",prop:"d_type","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"名称",prop:"d_name","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"报修人",prop:"repair_user"}}),a("el-table-column",{attrs:{label:"报修时间",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.common._convertDate(t.row.repair_time,"yyyy年MM月dd日")))]}}])}),a("el-table-column",{attrs:{label:"入库人",prop:"return_user"}}),a("el-table-column",{attrs:{label:"入库时间",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.common._convertDate(t.row.return_time,"yyyy年MM月dd日")))]}}])}),a("el-table-column",{attrs:{label:"状态",prop:"cur_status"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.common.transferRepairStatus(t.row.cur_status)))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",disabled:t.row.cur_status>1||!e.common.checkAuthority("Repair-return",!0)},on:{click:function(a){e.returnDevice(t.row)}}},[e._v("入库")]),a("el-button",{attrs:{type:"danger",size:"mini",disabled:t.row.cur_status>1||!e.common.checkAuthority("Repair-scrap",!0)},on:{click:function(a){e.scrapDevice(t.row,"2")}}},[e._v("报废")])]}}])})],1)],1):a("div",{staticClass:"text-center text-info"},[e._v(" 你无权查看此内容 ")])]),e.common.checkAuthority("Repair-list",!0)?a("div",{staticClass:"router-view-bottom"},[a("div"),a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":e.pageNum,"page-size":e.pageSize,total:e.tableData.total},on:{"size-change":e.pageSizeChange,"current-change":e.pageCurrentChange}})],1):a("div",{staticClass:"router-view-bottom"},[a("div")])])],1)},s=[],o={data:function(){return{typeTree:JSON.parse(sessionStorage.getItem("typeTree"))||[],typeTreeProps:{label:"d_name",value:"id",children:"children"},modelList:null,searchForm:{types:[],model_id:null,cur_status:null},tableData:{rows:[],total:0},pageNum:1,pageSize:10}},mounted:function(){this.common.checkAuthority("Repair-list",!0)&&(this.searchForm.cur_status=this.common.curStatus[0].id,this.getTableList())},methods:{getTableList:function(e){var t=this;this.tableLoading=!0;var a=this.searchForm;e&&(this.pageNum=1,this.pageSize=10),a.pageNum=this.pageNum,a.pageSize=this.pageSize;var r={method:"post",url:"".concat(this.common.basePath,"/repair/list"),data:JSON.parse(JSON.stringify(a))};this.searchForm.types&&this.searchForm.types.length>0&&(r.data.type=this.searchForm.types[this.searchForm.types.length-1]),delete r.data.types,this.axios(r).then(function(e){t.tableData=e.data.data,t.$nextTick(function(e){t.tableLoading=!1})}).catch(function(e){t.tableLoading=!1,t.$message.error(e)})},pageSizeChange:function(e){this.pageSize=e,this.getTableList()},pageCurrentChange:function(e){this.pageNum=e,this.getTableList()},returnDevice:function(e){var t=this;this.common.returnDevice(e,"/repair/recovery").then(function(e){t.getTableList()}).catch(function(e){})},scrapDevice:function(e,t){var a=this;this.common.scrapDevice(e,t).then(function(e){a.getTableList()}).catch(function(e){})},clearForm:function(){this.searchForm={types:[],model_id:null,cur_status:null}},cascaderChanged:function(e){this.searchForm.model_id=null,this.getModelList(e[e.length-1])},getModelList:function(e){var t=this,a={method:"get",url:"".concat(this.common.basePath,"/spec/select/model/public"),params:{id:e,pageNum:1,pageSize:999}};this.axios(a).then(function(e){t.modelList=e.data.data.rows,t.$refs.deviceForm&&t.$refs.deviceForm.resetFields()}).catch(function(e){t.$message.error(e)})}}},l=o,i=(a("6beb"),a("2877")),c=Object(i["a"])(l,r,s,!1,null,null,null);c.options.__file="Repair.vue";t["default"]=c.exports},cb26:function(e,t,a){}}]);
//# sourceMappingURL=chunk-2c37.c8b85a54.js.map